(()=>{"use strict";var e={4:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=t.NAME=t.OBJ_TYPE=t.UNDEF_TYPE=t.FUNC_TYPE=t.UNKNOWN=t.EMPTY=void 0,t.EMPTY="",t.UNKNOWN="?",t.FUNC_TYPE="function",t.UNDEF_TYPE="undefined",t.OBJ_TYPE="object",t.NAME="name",t.VERSION="version"},37:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UploadRequestFactory=void 0;const r=i(400),n=i(524);t.UploadRequestFactory=class{constructor(e){this.settings=e}create(e){let t;const i=this.settings.transportMode||"S3";switch(i){case"POST":t=new r.ImagePostRequest(this.settings);break;case"S3":if(void 0===e)throw new Error("S3 transport mode requires a valid S3PutTicket.");t=new n.ImageS3Request(this.settings,e);break;default:throw new Error(`Unsupported transport mode: ${i}`)}return t}}},78:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageReader=void 0;const r=i(891),n=i(343),s=i(527),o=i(507),a=i(774);class l{static registerPlugin(e,t){l._plugins.push({mimeType:e,decoderFn:t})}static async decode(e,t){const i=await this._normalizeInput(e),r=await s.MimeReader.detectMime(i);for(const{mimeType:e,decoderFn:n}of this._plugins)if(r===e)return this._logger.debug(`Using plugin for MIME type: ${e}`),this._decodePlugin(n,i,t);if(this._isNativeSupported(r))return this._maybeDecodeNative(i,t);throw new Error(`Unsupported image format: ${r}`)}static getEXIF(e){const t=this;return new Promise((i,r)=>{const n=new FileReader;n.onload=function(r){let n,s,o=1;try{const a=r.target.result,l=new DataView(a);if(65496!==l.getUint16(0))return i({orientation:1});const c=t.__getRawEXIFData(l);if(!c)return i({orientation:1});const{tiffOffset:h,littleEndian:g,rawEXIF:u,IFD0Offset:d,IFD1Offset:p}=c;n=u,o=t.__getEXIFOrientation(l,d,g),s=t.__getEXIFThumbnail(l,h,p,g,e),i({orientation:o,rawEXIF:n,thumbnail:s})}catch(e){t._logger.warn("Error extracting EXIF data",e),i({orientation:o,rawEXIF:n,thumbnail:s})}},n.onerror=function(e){t._logger.error("Error reading EXIF data",e),r(new Error("Error reading EXIF data"))};try{(e?.slice?e.slice(0,65536):e).arrayBuffer().then(t=>{const i=new DataView(t);let r=2;for(;r+4<i.byteLength&&65505!==i.getUint16(r);)r+=1;if(r+4>=i.byteLength)n.readAsArrayBuffer(e);else{r+=2;const t=4+i.getUint16(r)-2;n.readAsArrayBuffer(e.slice(0,t))}})}catch(e){this._logger.error("Error reading Blob for EXIF data",e),r(new Error("Error reading Blob for EXIF data"))}})}static async injectBlobExif(e,t){if(this._logger.debug("Injecting EXIF data into JPEG Blob"),!t||0===t.byteLength)return this._logger.debug("No EXIF data to inject, returning original blob"),e;try{const i=new DataView(t.buffer,t.byteOffset,t.byteLength),{tiffOffset:r,IFD0Offset:n,littleEndian:s}=this.__parseExifMetadata(t),o=i.getUint16(r+n,s);let a=r+n+2;for(let e=0;e<o;e++,a+=12)if(274===i.getUint16(a,s)){i.setUint16(a+8,1,s);break}const l=t.byteLength+2,c=new Uint8Array(t.byteLength+4);c[0]=255,c[1]=225,c[2]=l>>8&255,c[3]=255&l,c.set(t,4);const h=await e.arrayBuffer(),g=new Uint8Array(h);if(255!==g[0]||216!==g[1])return this._logger.error("Input blob is not a JPEG! Cannot inject EXIF data."),e;const u=new Uint8Array(g.length+c.length);return u.set(g.subarray(0,2),0),u.set(c,2),u.set(g.subarray(2),2+c.length),new Blob([u],{type:"image/jpeg"})}catch(t){return this._logger.error("Error injecting EXIF data",t),e}}static calcMaxDimensions(e,t){const{width:i,height:r}=e;return!t||t<=0||i<=t&&r<=t?{width:i,height:r}:i>=r?{width:t,height:r*t/i}:{width:i*t/r,height:t}}static exifTransformCanvas(e,t){const{width:i,height:r}=e;return(()=>{t>=5&&t<=8&&(e.width=r,e.height=i);const n=(HTMLCanvasElement,e.getContext("2d"));switch(t){case 2:n.translate(i,0),n.scale(-1,1);break;case 3:n.translate(i,r),n.rotate(Math.PI);break;case 4:n.translate(0,r),n.scale(1,-1);break;case 5:n.rotate(.5*Math.PI),n.scale(1,-1);break;case 6:n.rotate(.5*Math.PI),n.translate(0,-r);break;case 7:n.rotate(.5*Math.PI),n.translate(i,-r),n.scale(-1,1);break;case 8:n.rotate(-.5*Math.PI),n.translate(-i,0)}return n})()}static _isNativeSupported(e){return["image/jpeg","image/png","image/webp","image/gif"].includes(e)}static _isIOS(){return"iOS"===a.Env.os}static async _normalizeInput(e){if("string"==typeof e){const t=await fetch(e);return await t.blob()}if(e instanceof File||e instanceof Blob)return e;if(e instanceof o.ExtendedFile)return e.getSource();throw new Error("Unsupported input type")}static async _sniffNativeResolution(e){const t=await e.slice(0,512).arrayBuffer(),i=new DataView(t),r=new Uint8Array(t);try{if(137===r[0]&&80===r[1])return{width:i.getUint32(16),height:i.getUint32(20)};if(71===r[0]&&73===r[1])return{width:i.getUint16(6,!0),height:i.getUint16(8,!0)};if(82===r[0]&&73===r[1]&&87===r[8]){i.getUint8(15);return{width:1+this.__getDataViewUint24(i,24),height:1+this.__getDataViewUint24(i,27)}}if(255===r[0]&&216===r[1])return this.__sniffJPEGResolution(e)}catch(e){throw this._logger.error("Error sniffing native resolution",e),e}throw new Error("Unsupported format or corrupt file.")}static async __sniffJPEGResolution(e){const t=[192,194],i=e.stream().getReader();let r=new Uint8Array,n=0;for(;n<65536;){const{value:e,done:s}=await i.read();if(s)break;if(!e)continue;const o=new Uint8Array(r.length+e.length);o.set(r),o.set(e,r.length),r=o,n+=e.length;for(let e=0;e<r.length-1;e++)if(255===r[e]&&255!==r[e+1]&&0!==r[e+1]){const n=r[e+1];if(t.includes(n)){if(e+8<r.length){const t=(r[e+5]<<8)+r[e+6],n=(r[e+7]<<8)+r[e+8];return i.cancel(),{width:n,height:t}}break}}}throw i.cancel(),new Error("SOF marker not found within first 64KB of JPEG data.")}static async _imageDecodeBlob(e,t){const{maxWidthOrHeight:i=4096,preserveHeaders:r=!1}=t||{},s=a.Capabilities.canSupportCanvas(),o=await this.getEXIF(e).catch(e=>(this._logger.error("Error getting EXIF data, defaulting to orientation 1:",e),{orientation:1})),l=o.orientation||1,c=(0,n.is_numeric)(l)&&1!=l&&!r&&!a.Capabilities.canAutoRotateImages();if(!s)return this._logger.warn("Canvas support is not available, returning Blob without conversion."),{blob:e,orientation:l,metadata:o};const h=await this._blobToImage(e),{width:g,height:u}=this.calcMaxDimensions(h,i),d=document.createElement("canvas");return d.width=g,d.height=u,1!=l&&this._logger.debug(`${c?"C":"Not c"}orrecting image with orientation ${l}`),(c?this.exifTransformCanvas(d,l):d.getContext("2d")).drawImage(h,0,0,h.width,h.height,0,0,g,u),1!==l&&(e=await this._canvasToBlob(d,1)),o&&o.rawEXIF&&(e=await this.injectBlobExif(e,o.rawEXIF)),{canvas:d,blob:e,orientation:l,metadata:o}}static async _bitmapDecodeBlob(e,t){if(!window.createImageBitmap)throw new Error("createImageBitmap is not supported in this environment.");const{maxWidthOrHeight:i=4096,preserveHeaders:r=!1}=t||{},s=a.Capabilities.canSupportCanvas(),o=await this.getEXIF(e).catch(e=>(this._logger.error("Error getting EXIF data, defaulting to orientation 1:",e),{orientation:1})),l=o.orientation||1,c=(0,n.is_numeric)(l)&&1!=l&&!r&&!a.Capabilities.canAutoRotateImages();if(!s)return this._logger.warn("Canvas support is not available, returning Blob without conversion."),{blob:e,orientation:l,metadata:o};const h=await createImageBitmap(e,{imageOrientation:c?"none":"from-image"}),{width:g,height:u}=this.calcMaxDimensions(h,i),d=document.createElement("canvas");return d.width=g,d.height=u,(c?this.exifTransformCanvas(d,l):d.getContext("2d")).drawImage(h,0,0,h.width,h.height,0,0,g,u),1!==l&&(e=await this._canvasToBlob(d,1)),o&&o.rawEXIF&&(e=await this.injectBlobExif(e,o.rawEXIF)),{canvas:d,blob:e,orientation:l,metadata:o}}static _blobToImage(e){return new Promise((t,i)=>{const r=URL.createObjectURL(e),n=new Image;n.onload=()=>{URL.revokeObjectURL(r),t(n)},n.onerror=i,n.src=r})}static _canvasToBlob(e,t){return new Promise((i,r)=>{try{e.toBlob(e=>{e?i(e):r(new Error("Failed to convert canvas to Blob"))},"image/jpeg",t)}catch(e){r(new Error(`Canvas to Blob conversion failed: ${e.message}`))}})}static async _decodePlugin(e,t,i){const r=t.type;try{const n=await e(t,i);return this._logger.debug(`Decoding result for MIME type: ${r}`,n),{canvas:n.canvas,blob:n.blob,orientation:n.orientation||n.metadata&&n.metadata.orientation||1,metadata:n.metadata||{}}}catch(e){throw this._logger.error(`Plugin decoding failed for MIME type: ${r}`,e),new Error(`Plugin decoding failed for MIME type: ${r}`)}}static async _maybeDecodeNative(e,t){let i;!function(e){e[e.BITMAP=1]="BITMAP",e[e.IMAGE=2]="IMAGE",e[e.PLUGIN=3]="PLUGIN"}(i||(i={}));const r=e.type,n=await this.__shouldUseNativeDecoder(e)?[i.BITMAP,i.IMAGE,i.PLUGIN]:[i.PLUGIN,i.BITMAP,i.IMAGE];let s;for(const o of n)switch(o){case i.BITMAP:try{this._logger.debug(`Attempting to decode image with ImageBitmap for MIME type: ${r}`);const i=await this._bitmapDecodeBlob(e,t);if(i)return i}catch(e){this._logger.error("Error decoding image with ImageBitmap:",e),s=new Error("Bad format, or insufficient resources available to decode image via ImageBitmap.")}break;case i.IMAGE:try{this._logger.debug(`Attempting to decode image with native Image for MIME type: ${r}`);const i=await this._imageDecodeBlob(e,t);if(i)return i}catch(e){this._logger.error("Error decoding image with native canvas:",e),s=new Error("Bad format, or insufficient resources available to decode image via native Image.")}break;case i.PLUGIN:{const i=this._plugins.find(e=>"image/*"===e.mimeType);if(i)try{this._logger.debug(`Using in-memory plugin for large file MIME type: ${r}`);const n=await i.decoderFn(e,t);return{canvas:n.canvas,blob:n.blob,orientation:n.orientation||n.metadata&&n.metadata.orientation||1,metadata:n.metadata||{}}}catch(e){this._logger.error("Error decoding image with in-memory plugin:",e),s=new Error("Bad format, or insufficient resources available to decode image via in-memory plugin.")}break}}if(s)throw s;throw new Error("Unsupported image format or corrupt file.")}static async __shouldUseNativeDecoder(e){if(!this._isNativeSupported(e.type))return!1;let t=0,i=0;try{({width:t,height:i}=await this._sniffNativeResolution(e))}catch(e){this._logger.error("Error sniffing native resolution:",e)}if(t>0&&i>0){const r=512e3,n=4096**2,s=t*i/1024e3,o=e.size/s;return this._isIOS()?t*i<=n:o<r}return!1}static __getDataViewUint24(e,t){return e.getUint8(t)|e.getUint8(t+1)<<8|e.getUint8(t+2)<<16}static __getRawEXIFData(e){let t=2;const i=e.byteLength;for(;t+4<i;){const r=e.getUint16(t);if(65505===r){t+=2;const r=e.getUint16(t);if(t+r>i)break;if(t+=2,1165519206!==e.getUint32(t)){this._logger.debug("No EXIF header signature found");break}const n=t-4,s=r+2,o=new Uint8Array(e.buffer,n,s),a=t+6,l=18761===e.getUint16(a,!1),c=a+e.getUint32(a+4,l),h=c+2+12*e.getUint16(c,l);let g=null;if(h+4<=i){const t=e.getUint32(h,l);if(0!==t){const e=a+t;e+2<=i&&(g=e)}}return{rawEXIF:o,tiffOffset:a,littleEndian:l,IFD0Offset:c,IFD1Offset:g}}if(65280&~r)break;t+=2,t+=e.getUint16(t)}return null}static __getEXIFOrientation(e,t,i){try{const r=e.getUint16(t,i);t+=2;for(let n=0;n<r;n++){const r=t+12*n;if(274===e.getUint16(r,i))return e.getUint16(r+8,i)}}catch(e){return this._logger.warn("Error extracting EXIF orientation",e),1}return 1}static __getEXIFThumbnail(e,t,i,r,n){if(i)try{const s=e.getUint16(t+i,r);let o=null,a=null;for(let n=0;n<s;n++){const s=t+i+2+12*n,l=e.getUint16(s,r),c=s+8;513===l&&(o=e.getUint32(c,r)),514===l&&(a=e.getUint32(c,r))}if(o&&a)return n.slice(t+o,t+o+a,"image/jpeg")}catch(e){return}}static __parseExifMetadata(e){const t=new DataView(e.buffer,e.byteOffset,e.byteLength),i=e.byteLength>6&&[69,120,105,102,0,0].every((e,i)=>t.getUint8(i)===e)?6:0,r=t.getUint16(i,!1),n=18761===r;if(18761!==r&&19789!==r)throw new Error("Bad TIFF BOM");if(42!==t.getUint16(i+2,n))throw new Error("Bad TIFF magic");const s=t.getUint32(i+4,n),o=i+s+2+12*t.getUint16(i+s,n);let a=null;return o+4<=t.byteLength&&(a=t.getUint32(o,n)),{littleEndian:n,tiffOffset:i,IFD0Offset:s,IFD1Offset:a}}}t.ImageReader=l,l._plugins=[],l._logger=r.Logger.getInstance()},87:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ImageUploader=void 0;const n=r(i(891)),s=i(343),o=i(420),a=i(529);t.ImageUploader=class{constructor(e,t){if(!(0,s.is_uri)(t.uploadUrl||""))throw new Error("Invalid upload URL provided in options.");t.resize&&(t.resize=(0,s.merge_options)(o.RESIZE_DEFAULTS,t.resize,["width","height"])),t.thumbnails&&(t.thumbnails=(0,s.merge_options)(o.THUMB_SIZE_DEFAULTS,t.thumbnails)),t.transportMode&&"S3"===t.transportMode&&(t.s3Options=(0,s.merge_options)(o.S3_OPTIONS_DEFAULTS,t.s3Options||{})),Object.defineProperty(t,"targetElement",{value:e,writable:!1,enumerable:!0,configurable:!1}),this.$targetElement=e,this.settings=Object.assign({},o.defaultOptions,t),this.uploader=new a.UploadController(this.settings),this.logger=n.default.getInstance()}initialize(){this.initializeFileInput(),this.settings.dropElement&&this.initializeDropZone(),this.uploader.initialize()}getInstance(){return this.$targetElement}getOption(e){return this.settings[e]}setOption(e,t){e in this.settings&&(this.settings[e]=t),this.logger.debug(`Option ${e} has been updated to`,t)}cancel(){this.reset()}destroy(){const e=$(this.settings.browseButton||"");this.reset();try{e?.off(".uploader"),this.$targetElement?.off(".uploader"),$(document).off(".uploader"),this.$fileInput&&(this.$fileInput?.off(),this.$fileInput?.remove(),this.$fileInput=void 0),this.$dropZone&&this.$dropZone?.off(".uploader"),this.$targetElement?.removeData("imageUploader")}catch(e){this.logger.debug("Error during destroy:",e),this.$fileInput&&this.$fileInput?.length&&this.$fileInput?.remove()}this.uploader.destroy(),this.logger.debug("imageUploader has been destroyed")}reset(){try{this.$fileInput&&this.$fileInput?.val(""),this.$dropZone&&this.$dropZone?.removeClass("active")}catch(e){this.logger.error("Error during reset:",e)}this.uploader.reset(),this.logger.debug("Uploader has been reset")}initializeFileInput(){if(this._validateInput(this.$fileInput,{type:"file",id:"file-upload-input",multiple:"multiple",tagName:"INPUT"}))return this.$fileInput;const e=this;if(this.$fileInput=$("<input>",{type:"file",id:"file-upload-input",multiple:!0}),$(document).on("mimeType.uploader",function(t,i){e.logger.debug("mimeType.uploader event triggered with accepted extensions:",i),e.$fileInput.attr("accept",i)}),this.settings.browseButton&&$(this.settings.browseButton).length){const t=$(this.settings.browseButton);t.on("click.uploader",function(i){$(i.target).is(t)&&(i.preventDefault(),i.stopPropagation(),e.$fileInput.trigger("click.uploader"))}),this.$fileInput.css({display:"none"})}return $("BODY").append(this.$fileInput),this.$fileInput.on("change",t=>{e.logger.debug("change event",Date.now());const i=t.target.files;e.uploader.filesAdded(i||[])}),this.$fileInput}initializeDropZone(){const e=this;if(this.settings.dropElement){if(this._validateInput(this.$dropZone))return this.$dropZone;this.$dropZone=$(this.settings.dropElement),this.$dropZone.length&&this.settings.dragDropEnabled&&(this.$fileInput||this.initializeFileInput(),this.$dropZone.on("click.uploader",function(t){e.$dropZone&&$(t.target).is(e.$dropZone)&&(t.stopPropagation(),e.$fileInput.trigger("click.uploader"))}),this.$dropZone.on("dragover.uploader",e=>{e.preventDefault(),this.$dropZone.addClass("active")}),this.$dropZone.on("dragleave.uploader",()=>{this.$dropZone.removeClass("active")}),this.$dropZone.on("drop.uploader",e=>{e.preventDefault(),this.$dropZone.removeClass("active");const t=e.originalEvent,i=t.dataTransfer?.files||null;this.uploader.filesAdded(i||[])}))}return this.$dropZone}_validateInput(e,t){if(!(e&&e instanceof $&&e.length))return!1;if(t)for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&e.attr(i)!==t[i]&&e.prop(i)!==t[i])return this.logger.debug(`Input element does not have the expected property: ${i}`),this.logger.debug(`Expected: ${t[i]}, Found: ${e.attr(i)||e.prop(i)}`),!1;return!0}}},88:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.imageUploader=o;const n=r(i(891)),s=i(87);function o(e,...t){if("string"==typeof e){const i=$(this[0]).data("eso-uploader");if(!i)throw new Error("Cannot set/get options on uninitialized uploader instance.");const r=i[e];if("function"==typeof r){const e=r.apply(i,t);return void 0===e?this:e}throw new Error(`Method '${e}' not found on uploader instance.`)}return this.each((t,i)=>{const r=$(i);let n=r.data("eso-uploader");n?(n.destroy(),r.removeData("eso-uploader"),n=new s.ImageUploader(r,e||{}),n.initialize(),r.data("eso-uploader",n)):(n=new s.ImageUploader(r,e||{}),n.initialize(),r.data("eso-uploader",n))})}n.default.getInstance().debug("Logger is already loaded and ready to use"),function(e){e.fn.imageUploader=o}($)},244:e=>{e.exports=JSON.parse('{"extension_only":[],"multi_part":{"47494638":[["3761",0,".gif","image/gif","Graphics interchange format file (GIF87a)"],["3961",0,".gif","image/gif","Graphics interchange format file (GIF89a)"]],"52494646":[["57454250",8,".webp","image/webp","WebP graphics file format"],["5745425056503820",8,".webp","image/webp","RIFF WebP File (VP8 Lossy Compression)"],["574542505650384c",8,".webp","image/webp","RIFF WebP File (VP8 Lossless)"],["5745425056503858",8,".webp","image/webp","RIFF WebP File (VP8 Extended File Format)"],["57454250",8,".webp","image/webp","RIFF WebP File"]],"ffd8ff":[["db",0,".jpg","image/jpeg","JPEG DCT-based image"],["e0",0,".jfif","image/jpeg","JPEG JFIF image"],["e1",0,".jpg","image/jpeg","JPEG Exif image"],["e2",0,".jpg","image/jpeg","JPEG ICC Profile image"],["e3",0,".jpg","image/jpeg","JPEG with proprietary metadata (APP3)"],["e8",0,".jpg","image/jpeg","JPEG SPIFF image"],["ee",0,".jpg","image/jpeg","JPEG JFIF image with APP1 marker"]],"424d":[["787878785c3030305c303030",0,".dib","image/bmp","Windows BMP image"],["",0,".dib","image/bmp","Windows BMP image"]]},"footers":[],"headers":[["25504446",0,".pdf","application/pdf","Adobe Portable Document Format file"],["0d0a25504446",0,".pdf","application/pdf","Adobe Portable Document Format file"],["5c3337375c3333305c333737",0,".jpe","image/jpeg","JPEG image"],["0000000c6a5020200d0a870a",0,".jp2","image/jp2","JPEG 2000 image"],["5c783839504e47",0,".png","image/png","PNG image"],["89504e470d0a1a0a",0,".png","image/png","Portable Network Graphics file"],["52494646",0,".webp","image/webp","RIFF WebP"],["6674797061766966",4,".avif","image/avif","AV1 Image format"],["6674797061766973",4,".avif","image/avif","AV1 Image format sequence (AVIS)"],["6674797068656963",4,".heif","image/heif","HEIF Image format"],["6674797068656978",4,".heic","image/heic","HEIC Image format (HEIX)"],["6674797068657663",4,".heic","image/heic","HEIC Animated Image format (HEVC)"],["6674797068657678",4,".heic","image/heic","HEIC Animated Image format (HEVX)"],["6674797068656973",4,".heic","image/heic","HEIC Image format (HEIS scalable)"],["667479706865696d",4,".heic","image/heic","HEIC Image format (HEIM multiview)"],["667479706865766d",4,".heic","image/heic","HEIC Animated Image format (HEIM multiview)"],["6674797068657673",4,".heic","image/heic","HEIC Animated Image format (HEIS scalable)"]]}')},290:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.oses=t.engines=t.browsers=void 0;const r=i(482),n=i(745),s=i(4);t.browsers=[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[s.NAME,s.VERSION],[/\s(opr)\/([\w\.]+)/i],[[s.NAME,"Opera"],s.VERSION],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?([\w\.]*)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi)\/([\w\.-]+)/i],[s.NAME,s.VERSION],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[s.NAME,"IE"],s.VERSION],[/(edge)\/((\d+)?[\w\.]+)/i],[s.NAME,s.VERSION],[/(yabrowser)\/([\w\.]+)/i],[[s.NAME,"Yandex"],s.VERSION],[/(comodo_dragon)\/([\w\.]+)/i],[[s.NAME,/_/g," "],s.VERSION],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i,/(uc\s?browser|qqbrowser)[\/\s]?([\w\.]+)/i],[s.NAME,s.VERSION],[/(dolfin)\/([\w\.]+)/i],[[s.NAME,"Dolphin"],s.VERSION],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[s.NAME,"Chrome"],s.VERSION],[/XiaoMi\/MiuiBrowser\/([\w\.]+)/i],[s.VERSION,[s.NAME,"MIUI Browser"]],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)/i],[s.VERSION,[s.NAME,"Android Browser"]],[/FBAV\/([\w\.]+);/i],[s.VERSION,[s.NAME,"Facebook"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[s.VERSION,[s.NAME,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[s.VERSION,s.NAME],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[s.NAME,[s.VERSION,n.mapper.str,r.maps.browser.oldsafari.version]],[/(konqueror)\/([\w\.]+)/i,/(webkit|khtml)\/([\w\.]+)/i],[s.NAME,s.VERSION],[/(navigator|netscape)\/([\w\.-]+)/i],[[s.NAME,"Netscape"],s.VERSION],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]+)*/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[s.NAME,s.VERSION]],t.engines=[[/windows.+\sedge\/([\w\.]+)/i],[s.VERSION,[s.NAME,"EdgeHTML"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s.NAME,s.VERSION],[/rv\:([\w\.]+).*(gecko)/i],[s.VERSION,s.NAME]],t.oses=[[/microsoft\s(windows)\s(vista|xp)/i],[s.NAME,s.VERSION],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s.NAME,[s.VERSION,n.mapper.str,r.maps.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s.NAME,"Windows"],[s.VERSION,n.mapper.str,r.maps.os.windows.version]],[/\((bb)(10);/i],[[s.NAME,"BlackBerry"],s.VERSION],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)[\/\s]([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego|contiki)[\/\s-]?([\w\.]+)*/i,/linux;.+(sailfish);/i],[s.NAME,s.VERSION],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s.NAME,"Symbian"],s.VERSION],[/\((series40);/i],[s.NAME],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s.NAME,"Firefox OS"],s.VERSION],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s.NAME,s.VERSION],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s.NAME,"Chromium OS"],s.VERSION],[/(sunos)\s?([\w\.]+\d)*/i],[[s.NAME,"Solaris"],s.VERSION],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s.NAME,s.VERSION],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[s.NAME,"iOS"],[s.VERSION,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i,/(macintosh|mac(?=_powerpc)\s)/i],[[s.NAME,"Mac OS"],[s.VERSION,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]+)*/i,/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms)/i,/(unix)\s?([\w\.]+)*/i],[s.NAME,s.VERSION]]},328:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageTransformer=void 0;const r=i(507),n=i(758),s=i(891);t.ImageTransformer=class{constructor(e){this.settings=e,this.logger=s.Logger.getInstance()}resizeToBlob(e){const t=this;return new Promise((i,s)=>{try{const o=t.settings.resize||!1,a=new n.ExtendedImage(!0);a.on("load",function(){!o||o.width>this.width&&o.height>this.height&&void 0===o.quality?(t.logger.debug("No resize needed for file",e.name),this.getAsBlob(1).then(t=>{this.destroy(),i({blob:t,file:e})}).catch(e=>{t.logger.error("Error getting blob without resize:",e),s(new Error(`Image resize failed: ${e.message}`))})):(t.logger.debug("Resizing file",e.name,"to",o.width,"x",o.height,"at quality",o.quality),a.downsize(o.width,o.height,"image/jpeg",o.quality,o.crop,!0,!1,o.preserveHeaders,!1))}),a.on("resize",function(){this.getAsBlob(o?o.quality:1).then(n=>{const s=new r.ExtendedFile(new File([n],e.name,{type:n.type,lastModified:Date.now()}),{id:e.id});this.destroy(),t.logger.debug("Resized file",e.name,"to blob size",n.size),i({blob:n,file:s})}).catch(e=>{t.logger.error("Error getting resized blob:",e),this.destroy(),s(e)})}),a.bind("error runtimeerror",function(r){t.logger.error("Resize error: ",r),this.destroy(),i({blob:null,file:e})}),a.load(e.getSource()).catch(s)}catch(e){this.logger.error("Blob resize error",e),s(new Error(`Blob resize failed: ${e.message}`))}})}}},343:(e,t)=>{function i(e){var t,i;return!(!e||"[object Object]"!==Object.prototype.toString.call(e)||(t=Object.getPrototypeOf(e))&&("function"!=typeof(i=Object.prototype.hasOwnProperty.call(t,"constructor")&&t.constructor)||Function.prototype.toString.call(i)!==Function.prototype.toString.call(Object)))}function r(e){return Array.isArray(e)}function n(e,t){const i=e=>Object.prototype.toString.call(e).slice(8,-1);if(void 0===t)return s(e);const r=i(e),o=i(t);if(r!==o)return s(t);if("Array"===o){const i=[],r=Math.max(e.length,t.length);for(let o=0;o<r;o++)i[o]=o in t?o in e?n(e[o],t[o]):s(t[o]):s(e[o]);return i}if("Object"===o){const i={};for(const t of Reflect.ownKeys(e))i[t]=s(e[t]);for(const r of Reflect.ownKeys(t))i[r]=r in e?n(e[r],t[r]):s(t[r]);return i}if("Date"===o)return new Date(t.getTime());if("RegExp"===o){const e=t;return new RegExp(e.source,e.flags)}if("Map"===o){const e=new Map;return t.forEach((t,i)=>{e.set(i,s(t))}),e}if("Set"===o){const e=new Set;return t.forEach(t=>{e.add(s(t))}),e}return t}function s(e){const t={};switch(Object.prototype.toString.call(e).slice(8,-1)){case"Array":return e.map(s);case"Object":for(const i of Object.keys(e))t[i]=e[i];for(const i of Object.getOwnPropertySymbols(e))t[i]=e[i];return t;case"Date":return new Date(e.getTime());case"RegExp":{const t=e;return new RegExp(t.source,t.flags)}case"Map":{const t=new Map;return e.forEach((e,i)=>t.set(i,s(e))),t}case"Set":{const t=new Set;return e.forEach(e=>t.add(s(e))),t}default:return e}}function o(...e){return console.log(e.join(" "))}function a(e){const t=/\W*function\s+([\w$]+)\s*\(/.exec(e.toString());return t?t[1]:"(Anonymous)"}function l(e){const t=Math.floor(Number(e));return t!==1/0&&String(t)===e&&t>=0}function c(e){return new Array(e+1).join(" ")}function h(e){let t,i,r,n=0,s=typeof e;if("object"===s&&e&&e.constructor&&"LOCUTUS_Resource"===a(e.constructor))return"resource";if("function"===s)return"function";if("object"===s&&!e)return"null";if("object"===s){if(!e.constructor)return"object";for(r=e.constructor.toString(),t=r.match(/(\w+)\(/),t&&(r=t[1].toLowerCase()),i=["boolean","number","string","array"],n=0;n<i.length;n++)if(r===i[n]){s=i[n];break}}return s}function g(e,t){let i="";for(let r=0;r<e;r++)i+=t;return i}function u(e,t){let i="";if(null===e)i="NULL";else if("boolean"==typeof e)i="bool("+e+")";else if("string"==typeof e)i="string("+e.length+') "'+e+'"';else if("number"==typeof e)i=parseFloat(`${e}`)===parseInt(`${e}`,10)?"int("+e+")":"float("+e+")";else if(void 0===e)i="undefined";else if("function"==typeof e){const r=e.toString().split("\n");i="";for(let e=0,n=r.length;e<n;e++)i+=(0!==e?"\n"+t:"")+r[e]}else if(e instanceof Date)i="Date("+e+")";else if(e instanceof RegExp)i="RegExp("+e+")";else if(e.nodeName)switch(e.nodeType){case 1:i=void 0===e.namespaceURI||/https?:\/\/www\.w3\.org\/1999\/xhtml/i.test(e.namespaceURI)?'HTMLElement("'+e.nodeName+'")':'XML Element("'+e.nodeName+'")';break;case 2:i="ATTRIBUTE_NODE("+e.nodeName+")";break;case 3:i="TEXT_NODE("+e.nodeValue+")";break;case 4:i="CDATA_SECTION_NODE("+e.nodeValue+")";break;case 5:i="ENTITY_REFERENCE_NODE";break;case 6:i="ENTITY_NODE";break;case 7:i="PROCESSING_INSTRUCTION_NODE("+e.nodeName+":"+e.nodeValue+")";break;case 8:i="COMMENT_NODE("+e.nodeValue+")";break;case 9:i="DOCUMENT_NODE";break;case 10:i="DOCUMENT_TYPE_NODE";break;case 11:i="DOCUMENT_FRAGMENT_NODE";break;case 12:i="NOTATION_NODE"}return i}function d(e,t,n,s,o){t>0&&t++;const l=g(n*(t-1),s),c=g(n*(t+1),s);let h="",p="",f=0;if("object"==typeof e&&null!==e&&(i(e)||r(e))){if(o.has(e))return"Circular Reference Detected\n";if(o.set(e,!0),e.constructor&&"LOCUTUS_Resource"===a(e.constructor))return e.var_dump();f=0;for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&f++;h+="array("+f+") {\n";for(const i in e){const r=e[i];"object"!=typeof r||null===r||r instanceof Date||r instanceof RegExp||r.nodeName?(p=u(r,c),h+=c,h+="[",h+=i,h+="] =>\n",h+=c,h+=p,h+="\n"):(h+=c,h+="[",h+=i,h+="] =>\n",h+=c,h+=d(r,t+1,n,s,o))}h+=l+"}\n"}else h=u(e,c);return h}Object.defineProperty(t,"__esModule",{value:!0}),t.is_plain_object=i,t.var_export=function(e,t,i){let r=0;const n=i||2;return function e(t,i,s){r++;const a=1===r;let g,u="",d="",p=0;const f=[];let m,w=0;const b=s||2;let E="",_="";const y=h(t);if("null"===y)u="NULL";else if("array"===y||"object"===y){for(w in _=c(b-n),E=c(b),t){g=" ";const i=h(t[w]);"array"!==i&&"object"!==i||(g="\n"),g+=e(t[w],!0,b+n),w=l(w)?w:`'${w}'`,f[p++]=E+w+" =>"+g}f.length>0&&(d=f.join(",\n")+",\n"),u=(a?"":_)+"array (\n"+d+_+")"}else"function"===y?(m=t.toString().match(/function .*?\((.*?)\) \{([\s\S]*)\}/),u="create_function ('"+m[1]+"', '"+m[2].replace(/'/g,"\\'")+"')",u=u.replace(/[\r\n]+/g,".*")):u="resource"===y?"NULL":"string"!=typeof t?String(t):"'"+t.replace(/(['])/g,"\\$1").replace(/\0/g,"\\0")+"'";return r--,i||o(u),i?u:null}(e,t,i)},t.var_dump=function(...e){let t="",i=0;for(t=d(e[0],0,4," ",p),i=1;i<e.length;i++)t+="\n"+d(e[i],0,4," ",p);return o(t),t},t.is_numeric=function(e){const t=[" ","\n","\r","\t","\f","\v"," "," "," "," "," "," "," "," "," "," "," "," ","​","\u2028","\u2029","　"].join("");return("number"==typeof e||"string"==typeof e&&-1===t.indexOf(e.slice(-1)))&&""!==e&&!isNaN(e)&&isFinite(e)},t.prop_exists=f,t.merge_options=function(e,t,s){if(s&&r(s))for(const e of s)if(!i(t)||!f(t,e))return;return n(e,t)},t.is_uri=function(e){if("string"!=typeof e)return!1;const t=e.trim(),i=new RegExp("^(?<protocol>https?://)(?:(?<host>[A-Za-z0-9\\-]+)\\.)+(?<tld>[A-Za-z]{2,63})(?::(?<port>[0-9]{1,5}))?(?<path>/[A-Za-z0-9\\-._~%!$&'()*+,;=:@%]*)*(?<query>\\?[A-Za-z0-9\\-._~%!$&'()*\\+,;=:@%/?=]*)?(?<fragment>#[A-Za-z0-9\\-._~%!$&'()*\\+,;=:@%/?=]*)?$","i"),r=new RegExp("^(?!s*$)(?![^A-Za-z0-9]+$)(?![^/\\.]+$)(?![A-Za-z][A-Za-z0-9+.-]*:)(?!//)(?<leading>/)?(?<path>[A-Za-z0-9-_().]+(?:/(?<leaf>[A-Za-z0-9-_().]+))*)(?<query>\\?[A-Za-z0-9=&_%\\-\\+.]+)?(?<fragment>#[A-Za-z0-9\\-_]+)?$","i");return i.test(t)||r.test(t)},t.deep_clone=function e(t){if(null===t||"object"!=typeof t)return t;if("function"==typeof structuredClone)try{return structuredClone(t)}catch(e){console.debug("structuredClone failed, falling back to manual deep_clone",e)}if(t instanceof Blob)return t.slice(0,t.size,t.type);if(t instanceof ArrayBuffer)return t.slice(0);if(ArrayBuffer.isView(t)){const e=t.buffer,i=t.byteOffset,r=t.byteLength,n=t.constructor,s=new ArrayBuffer(r),o=new Uint8Array(e,i,r);return new Uint8Array(s).set(o),t instanceof DataView?new DataView(s):new n(s)}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return new RegExp(t.source,t.flags);if(t instanceof Map){const i=new Map;for(const[r,n]of t.entries())i.set(e(r),e(n));return i}if(t instanceof Set){const i=new Set;for(const r of t.values())i.add(e(r));return i}if(Array.isArray(t))return t.map(t=>e(t));const i={};for(const r of Object.keys(t))i[r]=e(t[r]);return i},t.debounce=function(e,t=300,i={}){const{leading:r=!1,trailing:n=!0}=i;let s,o,a,l=!1;const c=()=>{const t=o,i=a;return o=a=void 0,l=!0,e.apply(i,t)},h=function(...e){o=e,a=this,s?(clearTimeout(s),s=window.setTimeout(()=>{s=void 0,n&&c(),l=!1},t)):(r&&c(),s=window.setTimeout(()=>{s=void 0,!n||r&&!l||c(),l=!1},t))};return h.cancel=()=>{s&&clearTimeout(s),s=void 0,o=a=void 0,l=!1},h.flush=()=>{s&&(clearTimeout(s),s=void 0,n&&c(),l=!1)},h},t.throttle=function(e,t,i={}){const{leading:r=!0,trailing:n=!0}=i;let s,o,a,l=null;const c=()=>{l=Date.now(),e.apply(a,o),o=a=null};return function(...e){const i=Date.now();o=e,a=this,null===l||i-l>=t?r?c():l=i:n&&!s&&(s=window.setTimeout(()=>{s=void 0,n&&o&&c()},t-(i-l)))}},t.deferPromise=function(e){let t,i;return{id:e,promise:new Promise((e,r)=>{t=e,i=r}),resolve:t,reject:i}};const p=new Map;function f(e,t){const i=t.split(".").filter(Boolean);let r=e;if(!r||[void 0,null,""].includes(t)||0===i.length)return!1;if(!Object.prototype.hasOwnProperty.call(r,t))for(const e of i){if(void 0===r||null==r||!Object.prototype.hasOwnProperty.call(r,e))return!1;r=r[e]}return!0}},347:function(e,t,i){var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.UploadPipeline=void 0;const n=r(i(891)),s=i(420),o=i(673),a=i(343),l=i(979),c=i(507),h=i(774),g=i(328),u=i(942),d=i(37),p=i(483);t.UploadPipeline=class{constructor(e){this.active=!1,this.settings=e,this.logger=n.default.getInstance(),this.thumbnailService=new p.ThumbnailService(this.settings),this.imageTransformer=new g.ImageTransformer(this.settings),this.eventManager=l.EventManager.getInstance(e),this.requestFactory=new d.UploadRequestFactory(this.settings),this.ticketQueue=new u.QueueManager(1),this.transformQueue=new u.QueueManager(s.PIPELINE_CONCURRENCY.transform),this.requestQueue=new u.QueueManager(1),this.promises={ticket:new Map,transform:new Map},this.batchSize=this._normalizeBatchSize(this.settings.s3Options?.batch)}isActive(){return this.active}reset(){try{this.active=!1,this.ticketQueue.clear(),this.transformQueue.clear(),this.requestQueue.clear(),this.promises={ticket:new Map,transform:new Map},this.ticketQueue.setConcurrency(1),this.transformQueue.setConcurrency(s.PIPELINE_CONCURRENCY.transform),this.requestQueue.setConcurrency(1),console.debug("UploadPipeline reset.")}catch(e){console.error("Error during reset:",e)}}process(e){this.active=!0,this.logger.debug(`Starting upload pipeline with ${e.length} files.`),this.logger.debug("Starting upload pipeline with queue concurrencies:",JSON.stringify({ticket:this.ticketQueue.getConcurrency(),transform:this.transformQueue.getConcurrency(),request:this.requestQueue.getConcurrency()}));const t=(0,a.throttle)(this._onQueueProgress.bind(this),2e3);for(let t=0;t<e.length;t+=this.batchSize){const i=e.slice(t,t+this.batchSize);this._hasBatchS3Tickets()?this._batchQueueTickets(i):i.map(e=>this._queueTicket(e)),i.map(e=>this._queueTransform(e))}const i=e.map(e=>Promise.all([this._queueTicket(e),this._queueTransform(e)]).then(([e,{file:t,blob:i}])=>this._queueRequest(i,t,e)).then(()=>{}).then(()=>t()).catch(t=>{e.status===o.FILE_STATUS.QUEUED&&(e.status=o.FILE_STATUS.CANCELED),this.logger.error(`Error processing upload for ${e.name}:`,t)}));return Promise.allSettled(i).then(()=>Promise.all([this.ticketQueue.wait(),this.transformQueue.wait(),this.requestQueue.wait()])).then(()=>{this.active=!1})}_queueTicket(e){const t=e.id;if(!this._isS3TransportMode())return Promise.resolve(void 0);if(!this.promises.ticket.has(t)){if(this._hasBatchS3Tickets())return Promise.reject(new Error(`No S3 PUT ticket available for file ${e.name}.`));this.promises.ticket.set(t,this.ticketQueue.enqueue(()=>this._getTicket(e)))}return this.promises.ticket.get(t)}_queueTransform(e){const t=e.id;return this.promises.transform.has(t)||this.promises.transform.set(t,this.transformQueue.enqueue(()=>this._processThumbnail(e).then(()=>this._processTransform(e)))),this.promises.transform.get(t)}_queueRequest(e,t,i){return this.requestQueue.enqueue(()=>this._sendRequest(e,t,i))}_batchQueueTickets(e){const t=[];for(const i of e){const e=i.id;if(!this.promises.ticket.has(e)){const i=(0,a.deferPromise)(e);t.push(i),this.promises.ticket.set(e,i.promise)}}return this.ticketQueue.enqueue(()=>this._getTickets(e).then(e=>{for(const i of e){const e=i.id;if(this.promises.ticket.has(e)){const r=t.find(t=>t.id===e);r&&r.resolve(i)}}for(const i of t)e.find(e=>e.id===i.id)||i.reject(new Error(`Error obtaining S3 PUT ticket for file id: ${i.id}.`))})),t}_onQueueProgress(){const e=this._isS3TransportMode(),t=this._hasBatchS3Tickets(),i=this.transformQueue.load(!0),r=this.requestQueue.load(!0),n=this.ticketQueue.load(!0),o=t?n*this.batchSize:n,a=this.ticketQueue.load(!1)*(t?this.batchSize:1),l=s.PIPELINE_CONCURRENCY.ticket*(t?1:this.batchSize),c=Math.round(this.settings.s3Options?.maxConcurrency||l),h=s.PIPELINE_CONCURRENCY.transform,g=this.settings?.parallel||s.PIPELINE_CONCURRENCY.request,u=this.requestQueue.getConcurrency(),d=this.transformQueue.getConcurrency(),p=this.ticketQueue.getConcurrency(),f=o+.5*i,m=this._isMobileDevice();0===i&&r>10||!m&&i>10?this.transformQueue.setConcurrency(Math.min(h,d+1)):m&&i>20&&r<2&&this.transformQueue.setConcurrency(Math.max(1,d-1)),e&&(o>=5&&r<5?this.ticketQueue.setConcurrency(Math.min(c,p+1)):o>20&&r>10?this.ticketQueue.setConcurrency(Math.max(1,p-1)):a/(a+o)<.5?this.ticketQueue.setConcurrency(Math.min(c,p+1)):a/(a+o)>.75&&this.ticketQueue.setConcurrency(Math.max(Math.min(p,2),p-1))),f>15&&r>5?this.requestQueue.setConcurrency(Math.min(g,u+1)):r<=1&&i>10&&this.requestQueue.setConcurrency(Math.max(1,u-1)),this.ticketQueue.setConcurrency(Math.max(1,this.ticketQueue.getConcurrency())),this.transformQueue.setConcurrency(Math.max(1,this.transformQueue.getConcurrency())),this.requestQueue.setConcurrency(Math.max(1,this.requestQueue.getConcurrency()))}async _processThumbnail(e){return this.thumbnailService.generate(e).catch(t=>(this.logger.error(`Error generating thumbnail for: ${e.name}`,t),e))}async _processTransform(e){const t=this.eventManager.onBeforeUpload(e);if(!1===t){const t=new Error("Upload cancelled by user.");throw e.status=o.FILE_STATUS.FAILED,this.eventManager.onFileError(e,t),t}return e=t instanceof c.ExtendedFile?t:e,this.imageTransformer.resizeToBlob(e).catch(t=>{throw this.logger.error("Error during file conversion:",t),e.status=o.FILE_STATUS.FAILED,this.eventManager.onFileError(e,t),t})}async _sendRequest(e,t,i){if(!e){t.status=o.FILE_STATUS.FAILED;const e=new Error(`Unable to decode file: ${t.name}`);throw this.logger.error(e),e}const r=this._makeRequest(t,i);return t.status=o.FILE_STATUS.UPLOADING,this.eventManager.onUploadProgress(t,0),r.send(e,t).then(e=>(this.eventManager.onFileUploadComplete(t,e),e)).catch(e=>{throw this.logger.error("Error during file upload:",e),t.status=o.FILE_STATUS.FAILED,this.eventManager.onFileError(t,e),e})}_makeRequest(e,t){const i=this.requestFactory.create(t);return i.setFile(e),i}_getTicket(e){const t=this.settings.s3Options,i={[e.id]:e.name},r=new XMLHttpRequest;return new Promise((n,s)=>{if(!(0,a.is_plain_object)(t)||!t?.url){const e="S3 PUT tickets require valid S3 presign options.";return this.logger.error(e),s(new Error(e))}r.open("POST",t.url,!0),r.setRequestHeader("Content-Type","application/json");const o={...t};delete o.url,delete o.maxConcurrency,delete o.batch,t?.fileData||(o.fileData=i),r.onerror=()=>{const e=`Failed to fetch S3 PUT tickets: ${r.statusText}`;this.logger.error(e,r.responseText),s(new Error(e))},r.onload=()=>{if(200===r.status)try{const t=JSON.parse(r.responseText);if(t){if(t.errors)for(const i in t.errors)if(i===e.id){const e=t.errors[i],r=new Error(e.message);return this.logger.error(`Error obtaining S3 PUT ticket for ${e.filename}:`,r),s(r)}if(t.results&&(0,a.is_plain_object)(t.results))for(const i in t.results){const r=t.results[i];if(i===e.id&&r.ticket)return this.eventManager.onS3FilePresign(e,r?.media,r.ticket),n(r.ticket)}}const i=`Ticket not found for ${e.name}. Skipping ticket assignment.`;return this.logger.error(i),s(i)}catch(t){this.logger.error(`Error processing S3 PUT ticket for ${e.name}`,t),s(new Error(`Unable to request S3 PUT ticket for ${e.name}`))}else{const t=`Failed to fetch S3 PUT ticket for ${e.name}: ${r.statusText}`;this.logger.error(t,r.responseText),s(new Error(t))}},r.send(JSON.stringify(o))})}_getTickets(e){const t=this.settings.s3Options,i=e.reduce((e,t)=>(e[t.id]=t.name,e),{}),r=new XMLHttpRequest;return new Promise((n,s)=>{if(!(0,a.is_plain_object)(t)||!t?.url){const e="S3 PUT tickets require valid S3 presign options.";return this.logger.error(e),s(new Error(e))}r.open("POST",t.url,!0),r.setRequestHeader("Content-Type","application/json");const l={...t};delete l.url,delete l.maxConcurrency,delete l.batch,t?.fileData||(l.fileData=i),r.onerror=()=>{const e=`Failed to fetch S3 PUT tickets: ${r.statusText}`;this.logger.error(e,r.responseText),s(new Error(e))},r.onload=()=>{if(200===r.status)try{const t=[],i=JSON.parse(r.responseText);if(i){if(i.errors)for(const t in i.errors){const r=i.errors[t],n=e.find(e=>t===e.id);if(n){n.status=o.FILE_STATUS.FAILED;const e=new Error(r.message);this.logger.error(`Error obtaining S3 PUT ticket for ${n.name}:`,e),this.eventManager.onFileError(n,e)}else this.logger.error(`File not found for ${r.filename}. Skipping ticket assignment.`)}if(i.results&&(0,a.is_plain_object)(i.results))for(const r in i.results){const n=i.results[r],s=e.find(e=>r===e.id);s&&n.ticket?(this.eventManager.onS3FilePresign(s,n?.media,n.ticket),t.push(n.ticket)):this.logger.error(`File not found for ${n.filename}. Skipping ticket assignment.`)}return n(t)}const l="Invalid S3 PUT tickets response.";return this.logger.error(l,i),s(new Error(l))}catch(t){const i=`Error processing S3 PUT ticket for ${e.length} files.`;this.logger.error(i,t),s(new Error(i))}else{const t=`Error processing S3 PUT ticket for ${e.length} files: ${r.statusText}`;this.logger.error(t,r.responseText),s(new Error(t))}},r.send(JSON.stringify(l))})}_normalizeBatchSize(e){return void 0===e||!1===e?1:!0===e?s.S3_TICKET_BATCH_SIZE:Number.isFinite(e)&&e>0?Math.round(e):1}_isS3TransportMode(){return"S3"===this.settings.transportMode}_hasBatchS3Tickets(){return this._isS3TransportMode()&&this.batchSize>1}_isMobileDevice(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(h.Env.agent)}}},400:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImagePostRequest=void 0;const r=i(673),n=i(738);class s extends n.ImageRequest{constructor(e){super(e)}cancel(){this.offset=0,super.cancel()}send(e,t){const i=this;let n=this.settings.chunkSize;return t.loaded=t.loaded||0,t.percent=t.percent||0,t.status=t.status||r.FILE_STATUS.QUEUED,this.active=!0,this.file=t,this.blob=e,new Promise((s,o)=>{e&&0!==e.size?(this.logger.debug("Starting upload for file",t.name,"of size",e.size),t.loaded&&(i.offset=t.loaded=n?n*Math.floor(t.loaded/n):0),t.status=r.FILE_STATUS.UPLOADING,this._uploadNextChunk().then(s,o).catch(o)):o(new Error("Invalid format provided for upload."))})}_uploadNextChunk(){return new Promise((e,t)=>{const i=this.settings.chunkSize,n=this.blob,s={};let o,a;this.file&&this.file.status===r.FILE_STATUS.UPLOADING&&this.active&&(s.name=this.file.target_name||this.file.name,i&&n.size>i?(a=Math.min(i,n.size-this.offset),o=n.slice(this.offset,this.offset+a)):(a=n.size,o=n),i&&(this.settings.sendChunkNumber?(s.chunk=Math.ceil(this.offset/i),s.chunks=Math.ceil(n.size/i)):(s.offset=this.offset,s.total=n.size)),!1!==this.eventManager.onBeforeChunkUpload(this.file,s,o,this.offset)?(this.logger.debug("Starting upload for chunk",s.chunk||1,"of file",this.file.name,"at offset",this.offset),this._uploadChunk(s,o,a).then(e,t).catch(t)):t(new Error("Upload cancelled by user")))})}_uploadChunk(e,t,i){return new Promise((n,s)=>{const o=this,a=new XMLHttpRequest,l=this.file;this.xhr=a,a.upload&&(a.upload.onprogress=function(e){l.loaded=Math.min(l.size,e.loaded),o._onFileProgress(l)}),a.onload=function(){if(a.status<200||a.status>=400)return o._handleError(a.responseText||"HTTP Error: "+a.status).then(n,s);if(o.retries=o.settings.maxRetries||0,i<o.blob.size?(o.offset+=i,l.loaded=Math.min(o.offset,o.blob.size),o.eventManager.onChunkUploadComplete(l,{offset:l.loaded,total:o.blob.size,response:a.responseText,status:a.status,responseHeaders:a.getAllResponseHeaders()}),"Android Browser"===o.browser&&o._onFileProgress(l)):l.loaded=l.size,t=null,o.offset&&!(o.offset>=o.blob.size))return o._delay(o._uploadNextChunk.bind(o),1).then(n,s);l.size!=l.origSize&&(o.logger.debug("File size changed, destroying blob copy for",l.name),o.blob=null),o._onFileProgress(l),l.status=r.FILE_STATUS.DONE,l.completeTimestamp=+new Date;try{const e=JSON.parse(a.responseText);n(e)}catch(e){const t=`Failed to parse response: ${a.responseText}`;o.logger.error(t,e),s(new Error(t))}},a.onerror=function(){o._handleError(`Network error: ${a.statusText}`).then(n,s)},a.onloadend=function(){o.xhr=null},a.onabort=function(){o._handleError("abort").then(n,s)},o.logger.debug("Starting upload for file",l.name,"at offset",o.offset),this._sendRequest(e,t)})}_sendRequest(e,t){const i=this.xhr||new XMLHttpRequest,r=new FormData,n=this.file.name;let s=this.settings.uploadUrl;if(this.xhr=i,this.settings.multipart){i.open("POST",s,!0);const e=this.settings.multipart_params;if(e&&"object"==typeof e)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&r.append(t,e[t]);r.append("media",t,n),i.send(r)}else s=this._buildUrl(this.settings.uploadUrl,$.extend({},e,this.settings.multipart_params)),i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/octet-stream"),i.send(t)}_handleError(e){let t;return void 0===e?(t="HTTP Error: ",t+=this?.xhr?this.xhr.status:"undefined"):"abort"===e?(t="Upload manually aborted",this.retries=0):t=e,this.retries-- >0?(this?.file&&this.logger.debug(`Retrying upload for ${this.file.name}.`,"Attempt #"+((this.settings.maxRetries||0)-this.retries)),this._delay(this._uploadNextChunk.bind(this),1e3)):(this?.file&&(this.file.loaded=this.offset),Promise.reject(this._toError(t)))}}t.ImagePostRequest=s},420:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultOptions=t.S3_OPTIONS_DEFAULTS=t.S3_TICKET_BATCH_SIZE=t.PIPELINE_CONCURRENCY=t.THUMB_SIZE_DEFAULTS=t.RESIZE_DEFAULTS=void 0;const r=i(774);t.RESIZE_DEFAULTS={quality:.9,preserveHeaders:!1,crop:!1},t.THUMB_SIZE_DEFAULTS={width:200,height:200},t.PIPELINE_CONCURRENCY={ticket:4,transform:r.Env.hardwareConcurrency,request:6},t.S3_TICKET_BATCH_SIZE=5,t.S3_OPTIONS_DEFAULTS={url:"",listing_id:0,lot:0,dbSave:1,prepend:0,processed:0,maxConcurrency:t.PIPELINE_CONCURRENCY.ticket,batch:t.S3_TICKET_BATCH_SIZE},t.defaultOptions={resize:void 0,filters:{},dragDropEnabled:!0,maxRetries:3,maxWidthOrHeight:1400,uploadUrl:"",browseButton:void 0,dropElement:void 0,multipart:!0,multipart_params:{},parallel:1,chunkSize:0,sendChunkNumber:!1,thumbnails:!1,transportMode:"S3",s3Options:void 0,initialize:function(){},onBeforeQueue:function(e){return e},onS3FilePresign:function(e,t,i){},onBeforeChunkUpload:function(e,t,i,r){},onBeforeUpload:function(e){return e},onPreviewThumbnail:function(e,t){},onUploadProgress:function(e,t,i){},onChunkUploadComplete:function(e,t){},onFileUploadComplete:function(e,t){},onAllUploadsComplete:function(e){},onFileError:function(e,t){},onError:function(e){}}},482:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.maps=void 0,t.maps={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}}},483:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ThumbnailService=t.AVATAR_URL=t.THUMB_SIZE_DEFAULTS=void 0;const r=i(891),n=i(979),s=i(758),o=i(507),a=i(942);t.THUMB_SIZE_DEFAULTS={width:200,height:200},t.AVATAR_URL="https://ui-avatars.com/api/",t.ThumbnailService=class{constructor(e){this.settings=e,this.logger=r.Logger.getInstance(),this.eventManager=n.EventManager.getInstance(e),this.queueManager=new a.QueueManager(this.settings.parallel||1)}async generateAll(e){if(this.settings.thumbnails){this.logger.debug(`Generating thumbnails for ${e.length} files:`);const t=await Promise.allSettled(e.map(e=>this.queueManager.enqueue(()=>this.generate(e))));return this.logger.debug("Thumbnail generation completed."),t.map((t,i)=>"fulfilled"===t.status?t.value:e[i])}return this.logger.debug("Thumbnails are not enabled. Skipping thumbnail generation."),Promise.resolve(e)}generate(e){try{return this._preload(e).catch(t=>(this.logger.warn(`Skipping thumbnail for ${e.name}:`,t.message),e))}catch(t){return this.logger.warn(`Failed to generate thumbnail for ${e.name}:`,t),Promise.resolve(e)}}_preload(e){return new Promise((t,i)=>{if(!this.settings?.thumbnails)return this.logger.debug("Thumbnails are not enabled or container is not specified."),void t(e);try{this._process(e).then(t).catch(()=>{this.logger.warn(`No thumbnail available for file ${e.name}. Generating fallback avatar.`),this._avatar(e).then(t).catch(i)})}catch(r){this.logger.warn(`Error preloading thumbnail for file ${e.name}. Falling back to avatar:`,r);try{this._avatar(e).then(t).catch(t=>{this.logger.warn(`Failed to generate avatar for file ${e.name}:`,t.message),i(t)})}catch(t){this.logger.warn(`Failed to generate avatar for file ${e.name}:`,t),i(t)}}})}_process(e){return new Promise((t,i)=>{const r=this,n=new s.ExtendedImage(!0),o=$(`<div id="${e.id}" class="file_thumb thumb_preview"></div>`),{width:a,height:l}=this._resolution();n.on("load",function(){r.logger.debug(`Generating thumbnail for file ${e.name} (${n.width}x${n.height})`),n.embed(o[0],{width:a,height:l,crop:!0,fit:!1,preserveHeaders:!1})}),n.bind("embedded error",function(s){const a=o.find("canvas");if("error"!==s.type&&a.length)a.addClass("thumb_preview_canvas"),r.eventManager.onPreviewThumbnail(e,a),n.destroy(),s.target&&s.target!==n&&s.target.destroy(),t(e);else{const t=`Error generating thumbnail for file ${e.name}`;r.logger.error(t,s),n.destroy(),s.target&&s.target!==n&&s.target.destroy(),i(new Error(t))}}),n.load(e).catch(i)})}async _avatar(e){const i=((e&&e.name||"").split(".").pop()||"").toUpperCase(),r=new URL(t.AVATAR_URL),{width:n,height:s}=this._resolution();let a;r.searchParams.append("name",`.${i}`),r.searchParams.append("length","4"),r.searchParams.append("background","random"),r.searchParams.append("size",`${Math.min(n||0,s||0)}`),r.searchParams.append("font-size","0.3"),this.logger.debug(`Generating fallback avatar for file ${e.name} with URL: ${r}`);try{a=await fetch(r)}catch(t){const i=`Failed to load fallback image for ${e.name}`;throw this.logger.error(i,t),new Error(i)}try{const t=await a.blob(),r=new o.ExtendedFile(t);return r.name=`${e.name}_fallback-avatar.${i}`,this._process(r)}catch(t){const i=`Failed to convert fallback image for ${e.name}`;throw this.logger.error(i,t),new Error(i)}}_resolution(){const e="object"==typeof this.settings.thumbnails?this.settings.thumbnails.size:void 0,i=null!==(n=e)&&["object","function"].includes(typeof n)&&("width"in n||"height"in n)?e:t.THUMB_SIZE_DEFAULTS,r={};var n;return i.width&&(r.width=i.width),i.height&&(r.height=i.height),r}}},507:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedFile=void 0;const r=i(673);class n{constructor(e,t={}){if(!(e instanceof File||e instanceof Blob))throw new TypeError("Expected a File or Blob instance.");this.id=t.id||crypto.randomUUID(),this.name=e instanceof File?e.name:t.name||`file_${this.id}.${this._toExt(e.type)}`,this.target_name=t.name||this.name,this._file=e instanceof File?e:new File([e],this.name,{type:e.type}),this.lastModifiedDate=e instanceof File?new Date(e.lastModified):new Date,this.loaded=0,this.percent=0,this.status=r.FILE_STATUS.QUEUED,this.createdDate=new Date,this.origSize=e.size,this.completeTimestamp=void 0}getSource(){return this._file}get size(){return this._file.size}get type(){return this._file.type}slice(e,t,i){return this._file.slice(e,t,i)}_toExt(e){return e.split("/")[1]||"bin"}}t.ExtendedFile=n,n.FILE_STATUS=r.FILE_STATUS},524:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageS3Request=void 0;const r=i(673),n=i(738);class s extends n.ImageRequest{constructor(e,t){super(e),this.ticket=t}send(e,t){return t.loaded=t.loaded||0,t.percent=t.percent||0,t.status=t.status||r.FILE_STATUS.QUEUED,this.active=!0,this.file=t,this.blob=e,new Promise((i,n)=>{e&&0!==e.size?(this.logger.debug("Starting upload for file",t.name,"of size",e.size),t.status=r.FILE_STATUS.UPLOADING,this._preTransport(e).then(i,n).catch(n)):n(new Error("Invalid format provided for upload."))})}_preTransport(e){const t=this;return new Promise((i,n)=>{const s=new XMLHttpRequest,o=this.file;this.xhr=s,s.upload&&(s.upload.onprogress=function(e){o.loaded=Math.min(o.size,e.loaded),t._onFileProgress(o)}),s.onload=function(){if(s.status<200||s.status>=400)return t._handleError(s.responseText||"HTTP Error: "+s.status).then(i,n);t.retries=t.settings.maxRetries||0,o.loaded=o.size,o.size!=o.origSize&&(t.logger.debug("File size changed, destroying blob copy for",o.name),t.blob=null),t._onFileProgress(o),o.status=r.FILE_STATUS.DONE,o.completeTimestamp=+new Date;const e=s.getAllResponseHeaders().trim().split(/[\r\n]+/),a={};e.forEach(e=>{const t=e.split(": "),i=t.shift(),r=t.join(": ");i&&(a[i.toLowerCase()]=r)}),i(a)},s.onerror=function(){t._handleError(`Network error: ${s.statusText}`).then(i,n)},s.onloadend=function(){t.xhr=null},s.onabort=function(){t._handleError("abort").then(i,n)},t.logger.debug("Starting upload for file",o.name,"at offset",t.offset),this._sendRequest({},e)})}_sendRequest(e,t){const i=this.xhr||new XMLHttpRequest,r=this.ticket;i.open("PUT",r.url,!0),Object.entries(r.headers||{}).forEach(([e,t])=>{null!=t&&""!==t&&i.setRequestHeader(e,String(t))}),i.send(t)}_handleError(e){let t;return void 0===e?(t="HTTP Error: ",t+=this?.xhr?this.xhr.status:"undefined"):"abort"===e?(t="Upload manually aborted",this.retries=0):t=e,this.retries-- >0?(this?.file&&this.logger.debug(`Retrying upload for ${this.file.name}.`,"Attempt #"+((this.settings.maxRetries||0)-this.retries)),this._delay(()=>this._preTransport(this.blob),1e3)):(this?.file&&(this.file.loaded=0),Promise.reject(this._toError(t)))}}t.ImageS3Request=s},527:function(e,t,i){var r,n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MimeReader=void 0;const s=i(507),o=n(i(244));class a{static async detectMime(e){return new Promise((t,i)=>{const n=(e instanceof s.ExtendedFile||r._isSourcedFile(e)?e.getSource():e).slice(0,64),o=new FileReader;o.onloadend=e=>{const r=e.target&&e.target.result||void 0;if(r instanceof ArrayBuffer){const e=new Uint8Array(r),i=this._matchMagic(e);t(i)}else i(new Error("Unexpected result type from FileReader"))},o.onerror=()=>i(o.error),o.readAsArrayBuffer(n)})}static _bytesToHex(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}static _isSourcedFile(e){return e&&"function"==typeof e.getSource}static _matchMagic(e){const t=this._bytesToHex(e),i=r.MAGIC_DATA;function n(e,i){const[r,n,,s]=i;return r?t.slice(e.length+2*n,e.length+2*n+r.length)===r.toLowerCase()?s:null:s}let s=null;for(const e in i)switch(e){case"extension_only":case"footers":break;case"multi_part":for(const r in i[e])if(t.startsWith(r.toLowerCase()))for(const t of i[e][r])if(s=n(r,t))return s;break;case"headers":for(const t of i[e])if(s=n("",t))return s}return"unknown"}static _toMagic(e){function t(e){if(5!==e.length)throw new Error("Incorrect shape: magic data");const[t,i,r,n,s]=e;return[String(t),Number(i),String(r),String(n),String(s)]}if(null==e||"object"!=typeof e)throw new Error("Invalid value(s): magic data");const i={extension_only:[],multi_part:{},footers:[],headers:[]};for(const r of Object.keys(i)){const n=e[r];switch(r){case"multi_part":if("object"==typeof n&&null!==n){const e={};for(const i of Object.keys(n)){const r=n[i];if(!Array.isArray(r))throw new Error(`Expected array for multi_part.${i}`);e[i]=r.map(t)}i[r]=e}break;case"extension_only":case"footers":case"headers":Array.isArray(n)&&(i[r]=n.map(t));break;default:throw new Error(`Unexpected shape for key "${r}"`)}}return i}}t.MimeReader=a,r=a,a.MAGIC_DATA=r._toMagic(o.default)},529:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UploadController=void 0;const r=i(891),n=i(507),s=i(930),o=i(979),a=i(948),l=i(78),c=i(347);t.UploadController=class{constructor(e){this.settings=e,this.logger=r.Logger.getInstance(),this.fileProcessor=new s.FileProcessor(this.settings),this.eventManager=o.EventManager.getInstance(this.settings),this.pipeline=new c.UploadPipeline(this.settings)}initialize(){this.fileProcessor.observeFilters(),this._registerPlugins(),this.eventManager.onInitialize()}filesAdded(e){this.fileProcessor.applyFilters(e).then(e=>this._onFilesFiltered(e)).then(e=>this.fileProcessor.initialize(e.map(e=>e.file))).then(e=>this._onBeforeQueue(e)).then(e=>this.pipeline.process(e).then(()=>this.handleAllUploadsComplete(e))).catch(e=>{this.logger.error("Error processing upload(s):",e),this.eventManager.onError(e),this.handleAllUploadsComplete([])})}async _onBeforeQueue(e){const t=this.eventManager.onBeforeQueue(e);if(!1===t){const e="Upload cancelled by user before queue processing.";throw this.logger.debug(e),new Error(e)}return Array.isArray(t)?t.filter(e=>e instanceof n.ExtendedFile):e}async _onFilesFiltered(e){const{accepted:t,rejected:i}=e;if(i.length>0)for(const e of i){const{file:t,reason:i}=e;this.eventManager.onFileError(t,i||"File rejected by filters")}if(0===t.length){const e="No files accepted for upload. All files were rejected by filters.";throw this.logger.warn(e),new Error(e)}return t}handleAllUploadsComplete(e){this.eventManager.onAllUploadsComplete(e);try{this.reset()}catch(e){this.logger.debug("Failed to reset uploadController instance:",e)}}reset(){this.pipeline.isActive()&&(this.pipeline.reset(),this.eventManager.onError("Upload manually cancelled")),this.logger.debug("UploadController reset.")}destroy(){this.reset(),this.fileProcessor=null,this.eventManager=null,this.settings=null,this.logger=null,this.pipeline=null,console.debug("UploadController destroyed.")}_registerPlugins(){const e=this.fileProcessor.getSupportedMimes(),t=a.PluginRegistry.getPlugins();if(t){if(e&&e.size>0)for(const i of e)t[i]&&(this.logger.debug(`Registering plugin for MIME type: ${i}`),l.ImageReader.registerPlugin(i,t[i]));t["image/*"]&&l.ImageReader.registerPlugin("image/*",t["image/*"])}else this.logger.warn("No plugins found for non web-native MIME types.")}}},609:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.UAParser=void 0;const r=i(745),n=i(290),s=i(4);t.UAParser=class{constructor(e){this._ua=typeof e===s.UNDEF_TYPE?window.navigator&&window.navigator.userAgent?window.navigator.userAgent:s.EMPTY:e}get ua(){return this._ua}set ua(e){this._ua=e}getBrowser(){return r.mapper.rgx.call(this,...n.browsers)}getEngine(){return r.mapper.rgx.call(this,...n.engines)}getOS(){return r.mapper.rgx.call(this,...n.oses)}getResult(){return{ua:this._ua,browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}}}},673:(e,t)=>{var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MIME_TYPES=t.FILE_STATUS=void 0,function(e){e[e.QUEUED=1]="QUEUED",e[e.UPLOADING=2]="UPLOADING",e[e.FAILED=4]="FAILED",e[e.DONE=5]="DONE",e[e.CANCELED=6]="CANCELED"}(i||(t.FILE_STATUS=i={})),t.MIME_TYPES={jpeg:"image/jpeg",jpg:"image/jpeg",jfif:"image/jpeg",png:"image/png",webp:"image/webp",heic:"image/heic",heif:"image/heif",gif:"image/gif",bmp:"image/bmp",avif:"image/avif",tiff:"image/tiff"}},696:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.pageData=void 0,t.pageData=window.pageData},738:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ImageRequest=void 0;const r=i(979),n=i(891),s=i(774),o=i(343);t.ImageRequest=class{constructor(e){this.settings=e,this.eventManager=r.EventManager.getInstance(e),this.logger=n.Logger.getInstance(),this.browser=s.Env.browser||"Unknown",this.retries=this.settings.maxRetries||0,this.offset=0,this.active=!1,this.canceled=!1,this.xhr=null,this.file=null,this.blob=null}cancel(){if(this.canceled=!0,this.active=!1,this.retries=0,this.file=null,this.blob=null,this.xhr&&this.xhr.readyState!==XMLHttpRequest.DONE)try{this.xhr?.abort()}catch(e){this.logger.debug("Error aborting xhr:",e)}finally{this.xhr=null}}send(e,t){return Promise.resolve()}getFile(){return this.file}setFile(e){this.file=e}_sendRequest(e,t){}_handleError(e){return Promise.resolve()}_onFileProgress(e){e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):100,this.eventManager.onUploadProgress(e,e.percent)}_buildUrl(e,t){let i="";if(t&&"object"==typeof t)for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)){const r=t[e];i+=(i?"&":"")+encodeURIComponent(e)+"="+encodeURIComponent(r)}return i&&(e+=(e.indexOf("?")>0?"&":"?")+i),e}_delay(e,t){return new Promise((i,r)=>{setTimeout(()=>{try{const t=e();t&&"function"==typeof t.then?t.then(i,r).catch(r):i(t)}catch(e){r(e)}},t)})}_toError(e){let t;try{const i="string"==typeof e?JSON.parse(e):e;e instanceof Error||i&&i instanceof Error?t=e:(t=this.__parseError(i),((0,o.is_plain_object)(i)||Array.isArray(i))&&(t.details=i))}catch(i){let r="[Unknown error]";try{r="string"==typeof e?e:String(e)}catch(e){r="[Unparsable error]"}t=new Error(r)}return t}__parseError(e){let t;try{t="function"==typeof e?.toString&&Object.prototype.hasOwnProperty.call(e,"toString")?e.toString():Reflect.has(e,"errorMessage")?e.errorMessage:Reflect.has(e,"message")?e.message:(0,o.is_plain_object)(e)?JSON.stringify(e):String(e)}catch(i){t=e}return new Error(t)}}},745:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.mapper=void 0;const r=i(4),n=(e,t)=>t.toLowerCase().includes(e.toLowerCase());t.mapper={rgx:function(...e){let t={};for(let e,i,n,s,o,a=0,l=null,c=arguments;a<c.length;a+=2){const h=c[a],g=c[a+1];if(0===Object.keys(t).length)for(n in g)s=g[n],t[Array.isArray(s)&&s.length?s[0]:s]=void 0;for(e=i=0;e<h.length;e++)if(l=h[e].exec(this.ua),l){for(n=0;n<g.length;n++)if(o=l[++i],s=g[n],Array.isArray(s)&&s.length){const[e,i,n,a]=s;2===s.length?t[e]=typeof i===r.FUNC_TYPE?i.call(this,o):i:3===s.length?t[e]=o?typeof i===r.FUNC_TYPE?i.call(this,o,n):o.replace(i,n):void 0:4===s.length&&(t[e]=o?a.call(this,o.replace(i,n)):void 0)}else t[s]=o||void 0;break}if(l)break}return t},str:(e,t)=>{t=t||{};for(const i in t){const s=t[i];if(typeof s===r.OBJ_TYPE&&Array.isArray(s)&&s.length){for(const t of s)if(n(t,e))return i===r.UNKNOWN?void 0:i}else if("string"==typeof s&&n(s,e))return i===r.UNKNOWN?void 0:i}return e}}},758:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ExtendedImage=t.IMAGE_EVENT_TYPES=void 0;const r=i(891),n=i(774),s=i(774),o=i(78),a=i(343);var l;!function(e){e.LOAD="load",e.ERROR="error",e.RESIZE="resize",e.EMBEDDED="embedded",e.RUNTIME_ERROR="runtimeerror"}(l||(t.IMAGE_EVENT_TYPES=l={}));class c{constructor(e){this.logger=r.Logger.getInstance(),this.useCache=void 0!==e&&!!e,this.image=new Image,this.blob=null,this.canvas=document.createElement("canvas"),this._events={},this.width=0,this.height=0,this.type="",this.crop=!1,this.fit=!0,this.preserveHeaders=!0,this.quality=.9,this.meta={orientation:1,rawEXIF:void 0,exif:null,thumbnail:void 0}}load(e,t){return this.useCache?this._hydrate(e,t):this._decode(e,t)}async clone(){const e=new c;let t=null;this.canvas instanceof HTMLCanvasElement&&(t=this._cloneCanvas(this.canvas),e.canvas=t),e.width=this.width,e.height=this.height,e.type=this.type,e.preserveHeaders=this.preserveHeaders,e.quality=this.quality,e.crop=this.crop,e.fit=this.fit;try{this.blob instanceof Blob?e.blob=this.blob.slice(0,this.blob.size,this.blob.type):e.canvas instanceof HTMLCanvasElement&&(e.blob=await this._canvasToBlob(t,this.quality,this.preserveHeaders)),e.image=await this._blobToImage(e.blob),e.meta={};for(const t in this.meta){const i=this.meta[t];i instanceof Blob?e.meta[t]=i.slice(0,i.size,i.type):e.meta[t]="object"==typeof i&&null!==i?(0,a.deep_clone)(i):i}return e}catch(e){throw new Error("Failed to clone instance: "+e.message)}}downsize(...e){let t;t="object"==typeof e[0]?Object.assign({width:0,height:0,type:"image/jpeg",quality:.9,crop:!1,fit:!0,multipass:!0,preserveHeaders:!0,includeBlob:!1},e[0]):{width:e[0],height:e[1],type:void 0!==e[2]?e[2]:"image/jpeg",quality:void 0!==e[3]?e[3]:.9,crop:void 0!==e[4]&&e[4],fit:void 0===e[5]||e[5],multipass:void 0===e[6]||e[6],preserveHeaders:void 0===e[7]||e[7],includeBlob:void 0!==e[8]&&e[8]},this.resize(t)}resize({width:e=0,height:t=0,type:i="image/jpeg",quality:r=.9,crop:n=!1,fit:s=!0,multipass:o=!0,preserveHeaders:a=!0,includeBlob:c=!1}){if(!document.createElement("canvas").getContext)throw new Error("Resizing by Canvas not supported in this environment.");if(!e&&!t)throw new TypeError("Width or height must be numeric non-zero values.");const h=this._imageToCanvas(this.image);r=r>1?r/100:r<=0?.9:r,e&&t&&n||({width:e,height:t}=this._calcMaxDimensions(h,Math.max(e,t))),this.canvas=n?this._cropCanvas(h,{width:e,height:t,fit:s,quality:r,multipass:o}):o?this._multiPassScale(h,e,t):this._scale(h,e,t),this.width=this.canvas.width,this.height=this.canvas.height,this.preserveHeaders=a,this.quality=r,this.type=i,this.crop=n,this.fit=s,c?this._canvasToBlob(this.canvas,this.quality,this.preserveHeaders).then(async e=>{const t=await this._cacheKey(e);this.blob=e,this.useCache&&!this._hasCache(t)&&(this.logger.debug("Saving resized ",`${this.canvas.width}x${this.canvas.height}`,"image to cache with key:",`${t}`),this._saveCache(t)),this._trigger("resize",{target:this,type:l.RESIZE})}).catch(e=>{this.logger.error("_canvasToBlob failed during resize:",e),this.blob=null,this._trigger("error",{error:e,type:l.ERROR,target:this})}):(this.blob=null,this._trigger("resize",{target:this,type:l.RESIZE}))}async embed(e,t={}){try{const i="string"==typeof e?document.querySelector(e):e;if(!(i instanceof HTMLElement))throw new TypeError("Invalid DOM element provided.");if(!this.width||!this.height)throw new Error("Image not loaded.");const{width:r=0,height:s=0,type:o=this.type||"image/jpeg",quality:a=this.quality||.9,crop:c=!1,fit:h=!0,preserveHeaders:g=!1}=t,u=await this._getMetaThumbnail()||await this.clone();if(u.downsize({width:r,height:s,type:o,quality:a,crop:c,fit:h,multipass:!1,preserveHeaders:g,includeBlob:!1}),n.Capabilities.canSupportCanvas()){const e=u.getCanvas();return i.innerHTML="",i.appendChild(e),void this._trigger("embedded",{target:u,type:l.EMBEDDED})}return this._trigger("error",{error:new Error("Canvas not supported"),type:l.ERROR,target:this})}catch(e){this._trigger("error",{error:e,type:l.ERROR,target:this})}}destroy(){this.image&&(this.image.onload&&(this.image.onload=null),this.image.onerror&&(this.image.onerror=null),URL.revokeObjectURL(this.image.src)),this._releaseCanvas(this.canvas),this.canvas=null,this.image=null,this.blob=null,this.meta=null,this._events={}}getMetadata(){return this.meta}getCanvas(){return this.canvas}getAsDataURL(e){const t=void 0!==e?e:this.quality,i=t>1?t/100:t<=0?.9:t;if(this.canvas instanceof HTMLCanvasElement)try{return this.canvas.toDataURL(this.type,i)}catch(e){return this.logger.debug(`Fallback to PNG: ${e.message}`),this.canvas.toDataURL("image/png")}throw new Error("Canvas not available. Image not loaded or processed.")}getAsBlob(e,t){const i=this,r=void 0!==t&&!!t,n=void 0!==e?e:this.quality,s=n>1?n/100:n<=0?.9:n;return new Promise((e,t)=>{this.blob?e(this.blob):this.canvas instanceof HTMLCanvasElement?i._canvasToBlob(i.canvas,s,r).then(t=>{i.blob=t,e(t)}).catch(t):t(new Error("Unable to retrieve Blob. Image not loaded or processed."))})}_decode(e,t){return new Promise((i,r)=>{o.ImageReader.decode(e,t).then(async({canvas:e,blob:s,orientation:o,metadata:a})=>{const c=URL.createObjectURL(s),h=await this._cacheKey(s);this.image=new Image,this.blob=s,this.meta=a||{},this.meta.orientation=o||1,this.type=s.type,this.image.onload=()=>{e&&e instanceof HTMLCanvasElement?(this._fixIOSCCanvas(e),this.canvas=e):n.Capabilities.canSupportCanvas()&&(this.canvas=this._imageToCanvas(this.image,t)),this.width=this.image.naturalWidth,this.height=this.image.naturalHeight,this.useCache&&!this._hasCache(h)&&(this.logger.debug(`Saving ${this.width}x${this.height} image to cache with key: ${h}`),this._saveCache(h)),this._trigger("load",{target:this,type:l.LOAD}),this.image.onload&&(this.image.onload=null),this.image.onerror&&(this.image.onerror=null),URL.revokeObjectURL(this.image.src),i(this)},this.image.onerror=e=>{this._trigger("error",{error:e,target:this,type:l.ERROR}),this.image.onload&&(this.image.onload=null),this.image.onerror&&(this.image.onerror=null),URL.revokeObjectURL(this.image.src),r(e)},this.image.src=c}).catch(r)})}_hydrate(e,t){const i=this,r="object"==typeof t?t:{},s=void 0===r.decodeOnFail||!!r.decodeOnFail;return new Promise((t,o)=>{this._cacheKey(e).then(a=>{if(this._hasCache(a))try{this.logger.debug(`Cache hit for key: ${a}. Hydrating image.`);const e=i._getCache(a),{blob:s,meta:c}=e;return this.blob=s,this.meta=c||{},this.meta.orientation=this.meta.orientation||1,this.type=s?.type||"",this.image=new Image,this.image.onload=()=>{n.Capabilities.canSupportCanvas()&&(i.canvas=i._imageToCanvas(i.image,r)),i.width=i.image.naturalWidth,i.height=i.image.naturalHeight,i._trigger("load",{target:i,type:l.LOAD}),i.image.onload&&(i.image.onload=null),i.image.onerror&&(i.image.onerror=null),URL.revokeObjectURL(i.image.src),t(i)},this.image.onerror=e=>{i._trigger("error",{error:e,target:i,type:l.ERROR}),i.image.onload&&(i.image.onload=null),i.image.onerror&&(i.image.onerror=null),URL.revokeObjectURL(i.image.src),o(e)},void(i.image.src=URL.createObjectURL(s))}catch(e){i.logger.error(`Error hydrating image from cache: ${e.message}`)}s?(this.logger.debug(`Cache miss for key: ${a}. Decoding image.`),this._decode(e,r).then(e=>{e.useCache&&!this._hasCache(a)&&(this.logger.debug("Saving decoded",`${e.width}x${e.height}`,"image to cache with key:",`${a}`),e._saveCache(a)),t(e)}).catch(e=>{i._trigger("error",{error:e,target:i,type:l.ERROR}),o(e)})):o(new Error("Image not found in cache."))})})}_isIOS(){return"iOS"===s.Env.os}_multiPassScale(e,t,i){let r=e;for(;.5*r.width>t||.5*r.height>i;){const e=document.createElement("canvas");e.width=Math.max(t,.5*r.width),e.height=Math.max(i,.5*r.height),e.getContext("2d").drawImage(r,0,0,e.width,e.height),this._fixIOSCCanvas(e),r=e}const n=document.createElement("canvas");return n.width=t,n.height=i,n.getContext("2d").drawImage(r,0,0,n.width,n.height),this._fixIOSCCanvas(n),n}_scale(e,t,i){const r=document.createElement("canvas");return r.width=t,r.height=i,r.getContext("2d").drawImage(e,0,0,t,i),this._fixIOSCCanvas(r),r}_calcMaxDimensions(e,t){const{width:i,height:r}=e;return!t||t<=0||i<=t&&r<=t?{width:i,height:r}:i>=r?{width:t,height:Math.round(r*t/i)}:{width:Math.round(i*t/r),height:t}}async _getMetaThumbnail(){const e=this.meta.thumbnail;let t;return e&&e instanceof Blob?(this.logger.debug("Using thumbnail from metadata."),t=new c,await t.load(e)):null}_cropCanvas(e,t){let i=0,r=0,n=e.width,s=e.height,o=e.width,a=e.height,l=t.width||0,c=t.height||0;const{fit:h=!0,multipass:g=!1}=t,u=document.createElement("canvas"),d=l/c;return e.width/e.height>d?(o=Math.round(e.height*d),i=Math.round((e.width-o)/2)):(a=Math.round(e.width/d),r=Math.round((e.height-a)/2)),u.width=o,u.height=a,u.getContext("2d").drawImage(e,i,r,o,a,0,0,o,a),this._fixIOSCCanvas(u),!h&&u.width<l&&u.height<c&&(l=n,c=s),this.width=l,this.height=c,g?this._multiPassScale(u,l,c):this._scale(u,l,c)}_cloneCanvas(e){const t=document.createElement("canvas");t.width=e.width,t.height=e.height,t.getContext("2d").drawImage(e,0,0);try{this._fixIOSCCanvas(t)}catch(e){this.logger.warn("Error fixing iOS canvas:",e)}return t}_releaseCanvas(e){if(e&&e instanceof HTMLCanvasElement)try{if(!document.body.contains(e)){e.width=1,e.height=1;const t=e.getContext("2d");t&&t.clearRect(0,0,1,1),"function"==typeof e.remove&&e.remove()}}catch(e){this.logger.warn("Error releasing canvas:",e)}}_fixIOSCCanvas(e){if(!this._isIOS())return;const t=e.getContext("2d"),i=e.height,r=e.width;if(!(i<10))try{const n=t.getImageData(0,Math.max(0,i-10),r,10)?.data;if(!n||!n.length)return;let s=!0;for(let e=3;e<n.length;e+=4)if(0!==n[e]){s=!1;break}s&&(e.height-=Math.min(10,e.height))}catch(e){this.logger.debug("Error fixing iOS canvas:",e)}}_canvasToBlob(e,t,i){const r=void 0!==t?t:this.quality,n=r>1?r/100:r<=0?.9:r;return new Promise((t,r)=>{try{e.toBlob(e=>{e?i&&this.meta&&this.meta.rawEXIF?o.ImageReader.injectBlobExif(e,this.meta.rawEXIF).then(e=>{t(e)}).catch(()=>{this.logger.warn("Failed to inject EXIF data, falling back to original Blob."),t(e)}):t(e):r(new Error("Failed to convert canvas to Blob"))},this.type||"image/jpeg",n)}catch(e){r(new Error(`Canvas to Blob conversion failed: ${e.message}`))}})}_blobToImage(e){return new Promise((t,i)=>{const r=URL.createObjectURL(e),n=new Image;n.onload=()=>{t(n)},n.onerror=i,n.src=r})}_imageToCanvas(e,t){const{maxWidthOrHeight:i=0}=t||{},r=Math.round,n=this._calcMaxDimensions(e,i),s=document.createElement("canvas");return s.width=r(n.width),s.height=r(n.height),s.getContext("2d").drawImage(e,0,0,e.width,e.height,0,0,r(n.width),r(n.height)),this._fixIOSCCanvas(s),s}_getCache(e){const t=c._cache.get(e);if(t)return{blob:t.blob,meta:t.meta};throw new Error(`Cache entry not found for key: ${e}`)}_hasCache(e){return c._cache.has(e)}_saveCache(e){const t=this.blob?(0,a.deep_clone)(this.blob):null,i="object"==typeof this.meta?(0,a.deep_clone)(this.meta):null;c._cache.set(e,{blob:t,meta:i})}async _cacheKey(e){const t="function"==typeof e.getSource?e.getSource():e;if("string"==typeof t)return`${t}-${(this.fit?"fit":"")+"-"+(this.crop?"crop":"")+"-"+(this.preserveHeaders?"preserveHeaders":"")}`;if(t instanceof File||t instanceof Blob){const e=512,i=t.slice(0,e),r=await i.arrayBuffer(),n=await crypto.subtle.digest("SHA-1",r);return`blob-${Array.from(new Uint8Array(n)).map(e=>e.toString(16).padStart(2,"0")).join("")}`}return`unknown-${this._uuid()}`}_uuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}on(e,t){this._events&&("string"==typeof e&&"function"==typeof t?(this._events[e]=this._events[e]||[],this._events[e].push(t.bind(this))):this.logger.warn(`Event name: ${e} must be a string and handler must be a function.`))}off(e,t){"string"==typeof e&&this._events?.[e]&&(t?this._events[e]=this._events[e].filter(e=>e!==t):delete this._events[e])}bind(e,t){let i;i="string"==typeof e?e.split(" ").map(e=>e.trim().toLowerCase()).filter(e=>!!e):Array.isArray(e)?e.filter(e=>"string"==typeof e).map(e=>e.trim().toLowerCase()).filter(e=>!!e):[],i.forEach(e=>this.on(e,t))}_trigger(e,t){const i=this._events[e];i&&i.forEach(e=>e(t))}}t.ExtendedImage=c,c._cache=new Map,c.EVENT_TYPES=l},774:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Env=t.Capabilities=void 0;const r=i(609);t.Capabilities={canAutoRotateImages:function(){let e=null;return function(){if(null!==e)return e;if(window.CSS&&CSS.supports)try{if(CSS.supports("image-orientation","from-image"))return e=!0,e}catch(e){}const t=document.createElement("img"),i=t.style;if("imageOrientation"in i||"webkitImageOrientation"in i||"mozImageOrientation"in i||"msImageOrientation"in i)return e=!0,e;try{t.style.display="none",document.body.appendChild(t),e=window.getComputedStyle&&"from-image"===window.getComputedStyle(t).imageOrientation,document.body.removeChild(t)}catch(i){e=!1,document.body.removeChild(t)}return e}}(),canSupportBlobs:function(){try{return!!new Blob}catch(e){return!1}},canSupport32KbDataURI:function(){return"IE"!==t.Env.browser||!t.Env.version||parseFloat(t.Env.version)>=9},canSupportCanvas:function(){return!!document.createElement("canvas").getContext||!!window.OffscreenCanvas}};const n=(new r.UAParser).getResult();t.Env={uaParser:r.UAParser,agent:n.ua,browser:n.browser.name,version:n.browser.version,os:n.os.name,osVersion:n.os.version,hardwareConcurrency:navigator?.hardwareConcurrency||2}},891:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Logger=t.LOG_LEVEL=void 0;const r=i(696);var n;!function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR"}(n||(t.LOG_LEVEL=n={}));class s{constructor(e=n.INFO){this.logLevel=n.INFO,this.logLevel=e,this.initialize()}initialize(){const e=Object.values(n).filter(e=>"string"==typeof e).map(e=>e.toLowerCase());for(const t of e){const e=n[t.toUpperCase()];if("function"==typeof this[t])switch(e){case n.ERROR:case n.WARN:this[t]=this.logLevel<=e?console[t].bind(console):()=>{};break;case n.INFO:case n.DEBUG:this[t]=this.logLevel<=e?console.log.bind(console):()=>{}}}}static getInstance(e){if(!s.instance){const t=void 0!==e?e:void 0!==r.pageData&&void 0!==r.pageData.loglevel?r.pageData.loglevel:n.INFO;s.instance=new s(t)}return s.instance}static setLogLevel(e){let t=n.INFO;"string"==typeof e?/^[0-3]$/.test(e)?t=parseInt(e,10):Object.keys(n).includes(e.toUpperCase())&&(t=n[e.toUpperCase()]):"number"==typeof e&&Object.values(n).includes(e)&&(t=e),s.instance?(s.instance.logLevel=t,s.instance.initialize()):s.instance=new s(t)}static getLogLevel(){return s.instance?s.instance.logLevel:n.INFO}error(...e){}warn(...e){}info(...e){}debug(...e){}static reset(){s.instance=null}}t.Logger=s,s.instance=null,t.default=s},930:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FileProcessor=void 0;const r=i(673),n=i(891),s=i(507),o=i(527);t.FileProcessor=class{constructor(e){this.settings=e,this.logger=n.Logger.getInstance(),this._fileSignatures=new Set}initialize(e){return Array.from(e).map(e=>new s.ExtendedFile(e))}applyFilters(e){return Promise.allSettled(Array.from(e).map(this._applyFilter.bind(this))).then(t=>{const i=[],r=[];for(let n=0;n<t.length;n++){const s=t[n],o="fulfilled"===s.status?s.value:{file:e[n],accepted:!1,reason:"unknown filter rejection"};(o.accepted?i:r).push({file:o.file,reason:o.reason})}return{accepted:i,rejected:r}})}observeFilters(){const{filters:e}=this.settings;if($.isPlainObject(e))if(e?.mime_types){const t=this._mimeToExts(this._getMimeTypes(e.mime_types));t.length&&$(document).trigger("mimeType.uploader",["."+t.join(",.")])}else this.logger.debug("No mime_types filter provided.");else this.logger.debug("Filters are not a plain object, skipping mime type observation.")}getSupportedMimes(){const{filters:e}=this.settings;return this._getMimeTypes(e?.mime_types)}async _applyFilter(e){const{filters:t}=this.settings;return t&&t.prevent_duplicates&&!this._isValidSignature(e)?{file:e,accepted:!1,reason:"prevent_duplicates filter rejected"}:this._isValidSize(e)?await this._isValidMime(e)?{file:e,accepted:!0,reason:void 0}:{file:e,accepted:!1,reason:"mime_types filter rejected"}:{file:e,accepted:!1,reason:"max_file_size filter rejected"}}_isValidSize(e){const{filters:t}=this.settings,i=t&&t.max_file_size?this._parseFileSize(t.max_file_size):1/0;return!(e.size>i)}async _isValidMime(e){const{filters:t}=this.settings,i=t&&t.mime_types?this._getMimeTypes(t.mime_types):null;if(i){const t=await this._getFileMime(e);if(!i.has(t))return!1}return!0}_isValidSignature(e){const t=`${e.name}-${e.size}`;return!this._fileSignatures.has(t)&&(this._fileSignatures.add(t),!0)}_getFileMime(e){return o.MimeReader.detectMime(e).then(t=>(this.logger.debug(`Detected MIME type: ${t} for file: ${e.name}`),t)).catch(t=>{if(this.logger.error(`Error detecting MIME type for file: ${e.name}`,t),e.type)return e.type;const i=((e.name||"").split(".").pop()||"").toLowerCase();return r.MIME_TYPES[i]||"application/octet-stream"})}_getMimeTypes(e){if(!Array.isArray(e))return new Set(this._parseExtensions(e||""));const t=e.flatMap(e=>e&&e.title&&e&&e.extensions?this._parseExtensions(e.extensions):(this.logger.debug("Invalid mime group:",e),[]));return new Set(t)}_parseExtensions(e){const t=e.split(",").map(e=>e.replace(/^\./,"")),i=new Set,n=new Set(Object.values(r.MIME_TYPES));for(let e=0;e<t.length;e++){const s=t[e].trim().toLowerCase();"image/*"===s?n.forEach(e=>{e.startsWith("image/")&&i.add(e)}):r.MIME_TYPES[s]?i.add(r.MIME_TYPES[s]):n.has(s)&&i.add(s)}return Array.from(i)}_parseFileSize(e){if("number"==typeof e)return e;if("string"!=typeof e)throw new Error("Invalid input: file size must be a number or a string.");const t={b:1,kb:1024,mb:1048576,gb:1024**3,tb:1024**4,pb:1024**5},i=e.trim().match(/^([\d.]+)\s*(b|kb|mb|gb|tb|pb)?([A-Za-z]*)?$/i);if(!i)throw new Error("Invalid file size format.");const r=parseFloat(i[1]),n=i[2]?i[2].toLowerCase():i[3]?i[3].toLowerCase():"b";if(!t[n])throw new Error(`Unknown unit: ${n}`);return r*t[n]}_mimeToExts(e){const t=Array.from(e),i=new Set;for(let e=0;e<t.length;e++)for(let n in r.MIME_TYPES)r.MIME_TYPES[n]===t[e]&&i.add(n);return Array.from(i)}}},942:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.QueueManager=void 0;class i{constructor(e){this.queue=[],this.active=new Set,this.concurrency=e&&e>0?e:1}enqueue(e){return new Promise((t,i)=>{const r={run:async()=>{try{this.active.add(r.run);const i=await e();t(i)}catch(e){i(e)}finally{this.active.delete(r.run),this._dequeue()}},reject:e=>{i(e??new Error("Queued task canceled before execution"))}};this.queue.push(r),this._dequeue()})}_dequeue(){for(;this.active.size<this.concurrency&&this.queue.length>0;){const e=this.queue.shift();e&&e.run()}}size(){return this.queue.length+this.active.size}load(e){return e?this.queue.length:this.active.size}isIdle(){return 0===this.queue.length&&0===this.active.size}wait(){return new Promise(e=>{const t=()=>{this.isIdle()?e():setTimeout(t,100)};t()})}clear(e){for(const t of this.queue)t.reject(e&&"string"==typeof e?new Error(e):e);this.queue=[],this.active.clear()}getConcurrency(){return this.concurrency}setConcurrency(e){this.concurrency=e}static getInstance(e){return i.instance||(i.instance=new i(e)),i.instance}}t.QueueManager=i,i.instance=null},948:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PluginRegistry=void 0;const r=i(891),n=i(696),s=i(774),o=i(507),a=i(78),l=i(527),c=i(343),h={"image/*":[`${n.pageData.SURLV}js/uploader/plugins/vips/vips.min.js`],"image/avif":[`${n.pageData.SURLV}js/uploader/plugins/avif/jsquash.bundle.js`],"image/heic":[`${n.pageData.SURLV}js/uploader/plugins/heic/heic2any.min.js`],"image/heif":[`${n.pageData.SURLV}js/uploader/plugins/heic/heic2any.min.js`],"image/bmp":[`${n.pageData.SURLV}js/uploader/plugins/bmp/bmp-js.min.js`,`${n.pageData.SURLV}js/uploader/plugins/avif/jsquash.bundle.js`]};class g{static _isIOS(){return"iOS"===s.Env.os}static _loadScripts(e,t={}){if(Array.isArray(e))return Promise.all(e.map(e=>this._loadScripts(e,t))).then(()=>{});const i=e;if(g._loadedScripts.has(i))return g._loadedScripts.get(i);const r=new Promise((e,r)=>{const n=document.createElement("script");n.src=i,n.async=!0,n.onload=()=>e(),n.onerror=()=>r(new Error(`Failed to load script: ${i}`)),Object.entries(t).forEach(([e,t])=>{n.setAttribute(e,t)}),document.head.appendChild(n)});return g._loadedScripts.set(i,r),r}static _normalizeInput(e){return new Promise((t,i)=>{"string"==typeof e?fetch(e).then(e=>e.blob()).then(e=>t(e)).catch(i):e instanceof o.ExtendedFile?t(e.getSource()):e instanceof File||e instanceof Blob?t(e):i(new Error("Unsupported input type"))})}static __imageToCanvas(e,t,i){return new Promise((r,n)=>{if(!g._CANVAS_SUPPORT)return n(new Error("Canvas and OffscreenCanvas are not supported in this environment"));const{width:s,height:o}=a.ImageReader.calcMaxDimensions(e,i),l=e=>{const i=window.OffscreenCanvas?new OffscreenCanvas(s,o):document.createElement("canvas");i.width=s,i.height=o;const l=g._AUTO_ROTATE?i.getContext("2d"):a.ImageReader.exifTransformCanvas(i,t);e instanceof HTMLImageElement?(l.drawImage(e,0,0,e.width,e.height,0,0,s,o),r(i)):e instanceof ImageData?(l.putImageData(e,0,0),r(i)):e instanceof ImageBitmap?(l.drawImage(e,0,0,e.width,e.height,0,0,s,o),r(i)):n(new Error("Unsupported input type for rendering to canvas"))};try{e instanceof HTMLImageElement?l(e):createImageBitmap(e,{resizeWidth:s,resizeHeight:o,resizeQuality:"high"}).then(l).catch(n)}catch(e){n(new Error(`Failed to convert source image: ${e.message}`))}})}static __canvasToBlob(e,t){return new Promise((i,r)=>{e instanceof OffscreenCanvas?e.convertToBlob({type:"image/jpeg",quality:t}).then(i).catch(r):e instanceof HTMLCanvasElement?e.toBlob(e=>{e?i(e):r(new Error("Failed to convert canvas to blob"))},"image/jpeg",t):r(new Error("Unsupported canvas type for conversion to Blob"))})}static __canRunVips(){const e=s.Env.agent;return!/\bCriOS\b/.test(e)||!/iPad/.test(e)}static initVips(){return new Promise((e,t)=>{if(g.__canRunVips())if(g._vips)e(g._vips);else{const i={crossOrigin:"anonymous"};g._loadScripts(h["image/*"],i).then(async()=>{const i={locateFile:(e,t)=>`${t}${e}`,print:e=>g._logger.debug(e.replace(/\\x1b\[[0-9;]*m/g,"")),noImageDecoding:!0,dynamicLibraries:[],preRun:e=>{e.setAutoDeleteLater(!0),e.setDelayFunction(e=>{window.cleanup=e})},postRun:e=>{const t=30,i=t=>0!==e.Utils.typeFind("VipsOperation",t);g._logger.debug("vips version:".padEnd(t),e.version()),g._logger.debug("Emscripten version:".padEnd(t),e.emscriptenVersion()),g._logger.debug("Concurrency:".padEnd(t),e.concurrency()),g._logger.debug("Cache max mem:".padEnd(t),e.Cache.maxMem()),g._logger.debug("Cache max operations:".padEnd(t),e.Cache.max()),g._logger.debug("Cache current operations:".padEnd(t),e.Cache.size()),g._logger.debug("Cache max open files:".padEnd(t),e.Cache.maxFiles()),g._logger.debug("Memory allocations:".padEnd(t),e.Stats.allocations()),g._logger.debug("Memory currently allocated:".padEnd(t),e.Stats.mem()),g._logger.debug("Memory high water:".padEnd(t),e.Stats.memHighwater()),g._logger.debug("Open files:".padEnd(t),e.Stats.files()),g._logger.debug("JPEG support:".padEnd(t),i("jpegload")?"yes":"no"),g._logger.debug("JPEG XL support:".padEnd(t),i("jxlload")?"yes":"no"),g._logger.debug("AVIF support:".padEnd(t),i("heifload")?"yes":"no"),g._logger.debug("PNG support:".padEnd(t),i("pngload")?"yes":"no"),g._logger.debug("TIFF support:".padEnd(t),i("tiffload")?"yes":"no"),g._logger.debug("WebP support:".padEnd(t),i("webpload")?"yes":"no"),g._logger.debug("GIF support:".padEnd(t),i("gifload")?"yes":"no"),g._logger.debug("SVG load:".padEnd(t),i("svgload")?"yes":"no"),g._logger.debug("Text rendering support:".padEnd(t),i("text")?"yes":"no")},printErr:e=>g._logger.error("stderr",e)};if("Vips"in window){const r=await window.Vips(i).catch(e=>(g._logger.error("Failed to initialize Vips:",e),null));r?(g._vips=r,e(r)):t(new Error("Vips initialization failed"))}else t(new Error("Vips library not loaded"))})}else t(new Error("Your browser does not support Vips. Vips initialization failed."))})}static preloadPlugins(){const e=[];for(const t in h)if(Object.prototype.hasOwnProperty.call(h,t))try{const i={crossOrigin:"anonymous"},r=g._loadScripts(h[t],i).catch(e=>{g._logger.error(`Error loading plugin for ${t}:`,e)});e.push(r)}catch(i){g._logger.error(`Error preparing plugin for ${t}:`,i),e.push(Promise.resolve())}return Promise.all(e)}static _decodeAvif(e,t){const{quality:i=1,maxWidthOrHeight:r=4096}=t||{};return new Promise((t,n)=>{g._normalizeInput(e).then(e=>{l.MimeReader.detectMime(e).then(s=>{if("image/avif"!==s)return n(new Error("File is not an AVIF image"));g._loadScripts(h["image/avif"],{crossOrigin:"anonymous"}).then(async()=>{if("jSquash"in window&&window.jSquash.avif)try{const n=await a.ImageReader.getEXIF(e),s=await e.arrayBuffer(),o=await window.jSquash.avif.decode(s),l=o instanceof ImageData?o:new ImageData(new Uint8ClampedArray(o.data),o.width,o.height),c=await window.jSquash.jpeg.encode(l,{quality:100*i}),h={blob:new Blob([c],{type:"image/jpeg"}),orientation:n.orientation||1,metadata:n};if(!g._CANVAS_SUPPORT)return t(h);g.__imageToCanvas(l,n.orientation||1,r).then(e=>(h.canvas=e,g.__canvasToBlob(e,i))).then(e=>{h.blob=e,t(h)}).catch(()=>{t(h)})}catch(e){n(new Error(`AVIF decode failed: ${e.message}`))}else n(new Error("jSquash AVIF plugin not loaded"))}).catch(e=>{n(new Error(`Failed to load AVIF plugin: ${e.message}`))})}).catch(e=>{n(new Error(`Unknown file type: ${e.message}`))})}).catch(e=>{n(new Error(`Unknown input for decoding AVIF: ${e.message}`))})})}static _decodeHeic(e,t){const{quality:i=1,maxWidthOrHeight:r=4096}=t||{};return new Promise((t,n)=>{g._normalizeInput(e).then(e=>{l.MimeReader.detectMime(e).then(s=>{if("image/heic"!==s&&"image/heif"!==s)return n(new Error("File is not a HEIC image"));g._loadScripts(h["image/heic"],{crossOrigin:"anonymous"}).then(async()=>{if("heic2any"in window&&window.heic2any)try{const n=await a.ImageReader.getEXIF(e),s=await window.heic2any({blob:e,toType:"image/jpeg",quality:i}),o={blob:s,orientation:n.orientation||1,metadata:n};if(!g._CANVAS_SUPPORT)return t(o);const l=URL.createObjectURL(s),c=new Image;c.onload=()=>{g.__imageToCanvas(c,n.orientation||1,r).then(e=>(o.canvas=e,g.__canvasToBlob(e,i))).then(e=>{o.blob=e,t(o)}).catch(()=>{t(o)}).finally(()=>{URL.revokeObjectURL(l)})},c.onerror=()=>{URL.revokeObjectURL(l),t(o)},c.src=l}catch(e){n(new Error(`HEIC decode failed: ${e.message}`))}else n(new Error("HEIC plugin not loaded"))}).catch(e=>{n(new Error(`Failed to load HEIC plugin: ${e.message}`))})}).catch(e=>{n(new Error(`Unknown file type: ${e.message}`))})}).catch(e=>{n(new Error(`Unknown input for decoding HEIC: ${e.message}`))})})}static _decodeBmp(e,t){const{quality:i=1,maxWidthOrHeight:r=4096}=t||{};return new Promise((t,n)=>{g._normalizeInput(e).then(e=>{l.MimeReader.detectMime(e).then(s=>{if("image/bmp"!==s)return n(new Error("File is not a BMP image"));g._loadScripts(h["image/bmp"],{crossOrigin:"anonymous"}).then(async()=>{if("bmpJs"in window&&"jSquash"in window)try{const n=await a.ImageReader.getEXIF(e),s=await e.arrayBuffer(),o=window.bmpJs.Buffer.from(s),l=await window.bmpJs.decode(o),c=new ImageData(new Uint8ClampedArray(l.data.buffer),l.width,l.height),h=await window.jSquash.jpeg.encode(c,{quality:100*i}),u={blob:new Blob([h],{type:"image/jpeg"}),orientation:n.orientation||1,metadata:n};if(!g._CANVAS_SUPPORT)return t(u);g.__imageToCanvas(c,n.orientation||1,r).then(e=>(u.canvas=e,g.__canvasToBlob(e,i))).then(e=>{u.blob=e,t(u)}).catch(()=>{t(u)})}catch(e){n(new Error(`BMP decode failed: ${e.message}`))}else n(new Error("BMP plugin not loaded"))}).catch(e=>{n(new Error(`Failed to load BMP plugin: ${e.message}`))})}).catch(e=>{n(new Error(`Unknown file type: ${e.message}`))})}).catch(e=>{n(new Error(`Unknown input for decoding BMP: ${e.message}`))})})}static _decodeVips(e,t){const{quality:i=1,maxWidthOrHeight:r=4096}=t||{},n=["image/jpeg","image/gif","image/png","image/webp","image/tiff"];return new Promise((t,s)=>{g._normalizeInput(e).then(e=>{l.MimeReader.detectMime(e).then(o=>{if(-1===n.indexOf(o))return s(new Error("File is not a supported image type"));try{g.initVips().then(async()=>{if(g._vips){const n=g._vips;let o=await e.arrayBuffer(),l=new Uint8Array(o);try{const s=await a.ImageReader.getEXIF(e),c=n.Image.newFromBuffer(l),h=r/Math.max(c.width,c.height),u=h<1?c.resize(h):c;g._logger.debug(`Orientation: ${s.orientation}`,`Auto-rotation: ${g._AUTO_ROTATE}`);const d=u.writeToBuffer(".jpg"),p=new Blob([d],{type:"image/jpeg"}),f={blob:p,orientation:s.orientation||1,metadata:s};if(!g._CANVAS_SUPPORT)return t(f);const m=URL.createObjectURL(p),w=new Image;w.onload=()=>{g.__imageToCanvas(w,s.orientation||1,r).then(e=>(f.canvas=e,g.__canvasToBlob(e,i))).then(e=>{f.blob=e,t(f)}).catch(()=>{t(f)}).finally(()=>{l=new Uint8Array(0),o=new ArrayBuffer(0),URL.revokeObjectURL(m)})},w.onerror=()=>{o=new ArrayBuffer(0),l=new Uint8Array(0),URL.revokeObjectURL(m),t(f)},w.src=m}catch(e){g._logger.error("Error converting image:",e),s(new Error(`Error converting image: ${e.message}`))}}else s(new Error("VIPs plugin not loaded"))}).catch(e=>{s(new Error(`Failed to load VIPs plugin: ${e.message}`))})}catch(e){s(new Error(`Failed to initialize VIPS: ${e.message}`))}}).catch(e=>{s(new Error(`Unknown file type: ${e.message}`))})}).catch(e=>{s(new Error(`Unknown input for decoding image: ${e.message}`))})})}static getPlugins(){const e=Object.keys;var t,i;return this._registry&&(t=this._registry,i=g.registry,e(t).length===e(i).length&&e(t).every(e=>t[e]===i[e]))||(this._registry=(0,c.deep_clone)(g.registry)),this._registry}}t.PluginRegistry=g,g._logger=r.Logger.getInstance(),g._loadedScripts=new Map,g._AUTO_ROTATE=s.Capabilities.canAutoRotateImages(),g._CANVAS_SUPPORT=s.Capabilities.canSupportCanvas(),g.registry={"image/avif":g._decodeAvif,"image/heic":g._decodeHeic,"image/heif":g._decodeHeic,"image/bmp":g._decodeBmp,"image/tiff":g._decodeVips,"image/*":g._decodeVips},g.preloadPlugins().catch(e=>r.Logger.getInstance().error("Failed to preload conversion plugin(s):",e)).then(g.initVips).catch(e=>r.Logger.getInstance().error("Failed to initialize VIPS library:",e))},979:(e,t,i)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.EventManager=void 0;const r=i(891),n=i(343),s=i(507);class o{constructor(e){this.handlers={},this.settings=e,this.logger=r.Logger.getInstance(),this.counts={total:0,uploaded:0,failed:0,progress:{}}}on(e,t){this.handlers[e]||(this.handlers[e]=[]),this.handlers[e].push(t)}off(e,t){if(this.handlers[e]){const i=this.handlers[e],r=i.indexOf(t);-1!==r&&i.splice(r,1)}}emit(e,...t){if(this.handlers[e]&&this.handlers[e].forEach(e=>e(...t)),this.settings.targetElement)try{this.settings.targetElement.trigger(e,t)}catch(t){this.logger.error(`Error triggering jQuery event "${e}":`,t)}}onInitialize(){const e="function"==typeof this.settings.initialize?this.settings.initialize():void 0;return this.emit("initialize.uploader",[e]),e}onBeforeQueue(e){const t="function"==typeof this.settings.onBeforeQueue?this.settings.onBeforeQueue(e):e;return this.emit("onBeforeQueue.uploader",[e,t]),Array.isArray(t)?(this.counts.total=t.length,this.counts.progress=t.reduce((e,t)=>(e[t.id]=0,e),{})):!1!==t&&(this.counts.total=e.length,this.counts.progress=e.reduce((e,t)=>(e[t.id]=0,e),{})),t}onS3FilePresign(e,t,i){"function"==typeof this.settings.onS3FilePresign&&this.settings.onS3FilePresign(e,t,i),this.emit("onS3FilePresign.uploader",[e,t,i])}onBeforeChunkUpload(e,t,i,r){const n="function"==typeof this.settings.onBeforeChunkUpload?this.settings.onBeforeChunkUpload(e,t,i,r):void 0;return this.emit("onBeforeChunkUpload.uploader",[e,t,i,r,n]),n}onBeforeUpload(e){const t="function"==typeof this.settings.onBeforeUpload?this.settings.onBeforeUpload(e):e;return this.emit("onBeforeUpload.uploader",[e,t]),t}onPreviewThumbnail(e,t){const i="function"==typeof this.settings.onPreviewThumbnail?this.settings.onPreviewThumbnail(e,t):void 0;return this.emit("onPreviewThumbnail.uploader",[e,t,i]),i}onUploadProgress(e,t){this.counts.progress[e.id]=Math.max(0,Math.min(t,100));const{uploaded:i,failed:r,total:n}=this.counts,s=i+r,o={uploaded:i,failed:r,queued:Math.max(0,n-s),percent:this._calcTotalProgress()};"function"==typeof this.settings.onUploadProgress&&this.settings.onUploadProgress(e,t,o),this.emit("onUploadProgress.uploader",[e,t,o])}onChunkUploadComplete(e,t){"function"==typeof this.settings.onChunkUploadComplete&&this.settings.onChunkUploadComplete(e,t),this.emit("onChunkUploadComplete.uploader",[e,t])}onFileUploadComplete(e,t){this.counts.uploaded++,this.counts.progress[e.id]=100,"function"==typeof this.settings.onFileUploadComplete&&this.settings.onFileUploadComplete(e,t),this.emit("onFileUploadComplete.uploader",[e,t])}onAllUploadsComplete(e){"function"==typeof this.settings.onAllUploadsComplete&&this.settings.onAllUploadsComplete(e),this.emit("onAllUploadsComplete.uploader",[e])}onFileError(e,t){this.counts.failed++,e instanceof s.ExtendedFile&&(this.counts.progress[e.id]=100),"function"==typeof this.settings.onFileError&&this.settings.onFileError(e,t),this.emit("onFileError.uploader",[e,t])}onError(e){"function"==typeof this.settings.onError&&this.settings.onError(e),this.emit("onError.uploader",[e])}reset(){this.counts={total:0,uploaded:0,failed:0,progress:{}},this.logger.debug("EventManager reset.")}_calcTotalProgress(){const{progress:e}=this.counts,t=Object.keys(e);return t.reduce((t,i)=>e[i]/100+t,0)/t.length*100}static getInstance(e){if(!o.instance){if(!e||!(0,n.is_plain_object)(e))throw new Error("A valid settings object is required for new EventManager instances.");o.instance=new o(e)}return o.instance}}t.EventManager=o,o.instance=null}},t={};!function i(r){var n=t[r];if(void 0!==n)return n.exports;var s=t[r]={exports:{}};return e[r].call(s.exports,s,s.exports,i),s.exports}(88)})();
//# sourceMappingURL=jquery.image_uploader.min.js.map